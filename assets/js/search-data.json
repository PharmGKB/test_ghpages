<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title> - PharmCAT</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-7ZP1HHBWTE"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-7ZP1HHBWTE', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>PharmCAT | The Pharmacogenomics Clinical Annotation Tool (PharmCAT) is an open-source tool that takes an individual’s genetic data and determines their respective drug-related genotypes and phenotypes. PharmCAT produces a personalized report with genotype-specific expert-reviewed drug prescribing recommendations.</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="PharmCAT" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="The Pharmacogenomics Clinical Annotation Tool (PharmCAT) is an open-source tool that takes an individual’s genetic data and determines their respective drug-related genotypes and phenotypes. PharmCAT produces a personalized report with genotype-specific expert-reviewed drug prescribing recommendations." /> <meta property="og:description" content="The Pharmacogenomics Clinical Annotation Tool (PharmCAT) is an open-source tool that takes an individual’s genetic data and determines their respective drug-related genotypes and phenotypes. PharmCAT produces a personalized report with genotype-specific expert-reviewed drug prescribing recommendations." /> <meta property="og:site_name" content="PharmCAT" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="PharmCAT" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"The Pharmacogenomics Clinical Annotation Tool (PharmCAT) is an open-source tool that takes an individual’s genetic data and determines their respective drug-related genotypes and phenotypes. PharmCAT produces a personalized report with genotype-specific expert-reviewed drug prescribing recommendations.","headline":"PharmCAT","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/images/pharmcat_header.png"}},"url":"/assets/js/search-data.json"}</script> <!-- End Jekyll SEO tag --> <script async defer data-website-id="714c506c-5f1e-4ea8-af79-fa80c02911c6" src="https://metrics.cpicpgx.org/j.js"></script> <style> h4 { font-size: 14px !important; font-weight: bold; text-transform: none; } h4 code { font-size: 0.9em; font-weight: bold; } h5 code { font-size: .9em; } .main-content ul, .main-content ol { padding-left: 2em; } .main-content dl { grid-template-columns: 16em 1fr; } .main-content dt::after { content: unset; } .altArg { font-size: .8em; font-weight: normal; } footer { position: relative; top: -1.5em; font-size: smaller; } </style> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/methods/" class="nav-list-link">Methods</a><ul class="nav-list "><li class="nav-list-item "><a href="/methods/Modules.html" class="nav-list-link">PharmCAT Modules</a></li><li class="nav-list-item "><a href="/methods/determining-alleles" class="nav-list-link">Determining Alleles</a></li><li class="nav-list-item "><a href="/methods/NamedAlleleMatcher-101.html" class="nav-list-link">Named Allele Matcher 101</a></li><li class="nav-list-item "><a href="/methods/NamedAlleleMatcher-201.html" class="nav-list-link">Named Allele Matcher 201</a></li><li class="nav-list-item "><a href="/methods/gene-definition-exceptions" class="nav-list-link">Gene Definition Exceptions</a></li><li class="nav-list-item "><a href="/methods/versioning/" class="nav-list-link">Versioning</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/using/" class="nav-list-link">Using PharmCAT</a><ul class="nav-list "><li class="nav-list-item "><a href="/using/Running-PharmCAT.html" class="nav-list-link">Running PharmCAT</a></li><li class="nav-list-item "><a href="/using/VCF-Preprocessor.html" class="nav-list-link">VCF Preprocessor</a></li><li class="nav-list-item "><a href="/using/PharmCAT-in-Docker.html" class="nav-list-link">PharmCAT in Docker</a></li><li class="nav-list-item "><a href="/using/Multi-Sample-Analysis.html" class="nav-list-link">Multi-Sample Analysis</a></li><li class="nav-list-item "><a href="/using/Calling-CYP2D6.html" class="nav-list-link">Calling CYP2D6</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/specifications/" class="nav-list-link">Specifications</a><ul class="nav-list "><li class="nav-list-item "><a href="/specifications/VCF-Requirements.html" class="nav-list-link">VCF Requirements</a></li><li class="nav-list-item "><a href="/specifications/preparing-vcf" class="nav-list-link">Preparing VCF</a></li><li class="nav-list-item "><a href="/specifications/Outside-Call-Format.html" class="nav-list-link">Outside Call Format</a></li></ul></li><li class="nav-list-item"><a href="/genes-drugs/" class="nav-list-link">Genes & Drugs</a></li><li class="nav-list-item"><a href="/examples/" class="nav-list-link">Examples</a></li><li class="nav-list-item"><a href="/faqs/" class="nav-list-link">FAQs</a></li><li class="nav-list-item"><a href="/disclaimers/" class="nav-list-link">Disclaimers and Other Information</a></li><li class="nav-list-item"><a href="/about-us/" class="nav-list-link">About Us</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search PharmCAT" aria-label="Search PharmCAT" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h{"0": { "doc": "About Us", "title": "About Us", "content": " ", "url": "/about-us/", "relUrl": "/about-us/" },"1": { "doc": "About Us", "title": "Co-PIs", "content": "Teri Klein (Stanford University) and Marylyn Ritchie (University of Pennsylvania) . ", "url": "/about-us/#co-pis", "relUrl": "/about-us/#co-pis" },"2": { "doc": "About Us", "title": "Current Team", "content": "| Name | Institution | . | Binglan Li | Stanford University | . | Katrin Sangkuhl | Stanford University | . | Mark Woon | Stanford University | . | Michelle Whirl-Carrillo | Stanford University | . | Ryan Whaley | Stanford University | . | Yuki Bradford | University of Pennsylvania | . | Scott Dudek | University of Pennsylvania | . | Sony Tuteja | University of Pennsylvania | . | Anurag Verma | University of Pennsylvania | . | Shefali Setia Verma | University of Pennsylvania | . | Karl Keat | University of Pennsylvania | . ", "url": "/about-us/#current-team", "relUrl": "/about-us/#current-team" },"3": { "doc": "About Us", "title": "Scientific Advisory Board", "content": "| Name | . | Burns Blaxall | . | Rhonda DeHoff | . | Phil Empey | . | Andrea Gaedigk | . | Houda Hachad | . | Jonathan Haines | . | James Hoffman | . | Stuart Scott | . | Sara Van Driest | . | Marc Williams | . ", "url": "/about-us/#scientific-advisory-board", "relUrl": "/about-us/#scientific-advisory-board" },"4": { "doc": "About Us", "title": "Past Contributors", "content": "| Name | Institution | . | Solomon Adams | University of Pittsburgh | . | Lester Carter | Stanford (formerly) | . | Mark Dunnenberger | Northshore University Health System | . | Philip Empey | University of Pittsburgh | . | Alex Frase | University of Pennsylvania | . | Robert Freimuth | Mayo Clinic | . | Andrea Gaedigk | Children’s Mercy Hospital | . | Adam Gordon | University of Washington | . | Cyrine Haidar | St Jude Children’s Research Hospital | . | James Hoffman | St Jude Children’s Research Hospital | . | Kevin Hicks | Moffitt Cancer Center &amp; Research Institute | . | Ming Ta (Mike) Lee | Geisinger | . | Neil Miller | Children’s Mercy Hospital | . | Sean Mooney | University of Washington | . | Minoli Perera | Northwestern University | . | Thomas Person | Geisinger | . | Josh Peterson | Vanderbilt University | . | Stuart Scott | Stanford University | . | Greyson Twist | Children’s Mercy Hospital | . | Marc Williams | Geisinger | . | Chunlei Wu | Scrips Research Institute | . | Wenjian Yang | St Jude Children’s Research Hospital | . ", "url": "/about-us/#past-contributors", "relUrl": "/about-us/#past-contributors" },"5": { "doc": "Calling CYP2D6", "title": "Calling CYP2D6", "content": "While PharmCAT supports CYP2D6, we do NOT recommend calling CYP2D6 from VCF due to the large influence of structural variation and copy number variation (CNV) on predicted phenotype, which is beyond the scope of what can be called from SNPs in a VCF. In particular, we strongly discourage using whole-exome sequencing or low coverage whole-genome sequencing data to call CYP2D6. ", "url": "/using/Calling-CYP2D6.html", "relUrl": "/using/Calling-CYP2D6.html" },"6": { "doc": "Calling CYP2D6", "title": "Why calling CYP2D6 from VCF is a Bad Idea", "content": "For demonstration purposes, we are using StellarPGx, which supports calling CYP2D6 with structural variants and CNV from whole genome sequencing (WGS) CRAM/BAM files. StellarPGx has been benchmarked against the CDC's GeT-RM dataset which provides ground truth sequencing data for benchmarking variant calling tools. According to the StellarPGx paper, StellarPGx produces results with a higher concordance to GeT-RM than other available CYP2D6 callers. However, this benchmark was performed using GeT-RM's short-read 30x PCR-free WGS dataset. In addition to high-coverage WGS, GeT-RM also provides access to low-coverage WGS and whole exome sequencing (WES) data for some samples. We selected 6 random Get-RM samples and ran StellarPGx on the high-coverage WGS, low-coverage WGS, and WES and compared the results to the GeT-RM ground truth calls. | Sample | WES | Low-Cov WGS | 30x WGS | GeT-RM | . | HG00436 | No_call | No_call | 71/2x2 | 2x2/71 | . | HG01086 | 1/1x2 | No_call | 1/31 | 1/31 | . | HG01190 | 1/1 | 5/1 | 5/68+*4 | 68+4/*5 | . | NA07048 | No_call | 1/1 | 139/4 | 1/4 | . | NA18545 | 34/34x7 | 1/1x5 | 36+10/36+10 | 5/36x2+*10x2 | . | NA21105 | No_call | 34/34 | 111/3 | 3/111 | . There is drastic variation in the calls produced by the three sequencing technologies. In many cases, the WES or low-coverage WGS input resulted in a \"no call\" result. Occasionally they produced improbably high copy numbers. They also produced star-allele calls which varied greatly from the GeT-RM calls. The 30x WGS produced identical or equivalent results most of the time, and when it deviated the differences were relatively minor. In conclusion, we do not recommend the use WES or low-coverage WGS for calling CYP2D6 for both research and clinical purposes. ", "url": "/using/Calling-CYP2D6.html#why-calling-cyp2d6-from-vcf-is-a-bad-idea", "relUrl": "/using/Calling-CYP2D6.html#why-calling-cyp2d6-from-vcf-is-a-bad-idea" },"7": { "doc": "Calling CYP2D6", "title": "Calling CYP2D6 Anyway", "content": "So now that you know the pitfalls, if you still want to call CYP2D6, you have 2 options: . | to use a different tool to call CYP2D6 | to run PharmCAT in research mode | . Using Outside Calls . PharmCAT supports pulling in results from other tools using what we call \"outside calls\". This allows you to select your preferred CYP2D6 caller and include CYP2D6 results in a PharmCAT report. To include external calls you need to use the -po flag in PharmCAT to specify the external calls file. For example: . # java -jar pharmcat.jar -vcf patient_001.vcf -po patient_001_cyp2d6.txt . where patient_001_cyp2d6.txt takes the format of: . # CYP2D6 *1x2/*2+*6 . | See Running PharmCAT for details on the -po flag | See Outside Call Format for details on the outside call file | . Formatting StellarPGx output for PharmCAT . As mentioned above, if you have whole genome sequencing (WGS) CRAM/BAM files, your best option is a tool like StellarPGx. Please note we are not affiliated with the StellarPGx team and offer no guarantees about its performance. Any questions or concerns on StellarPGx should be directed to the StellarPGx maintainers twesigomwedavid@gmail.com. Usage instructions for StellarPGx can be found on their github. While this tutorial is StellarPGx specific, it should illustrate how to integrate other external callers with PharmCAT. After running StellarPGx with CYP2D6 as the target gene, it should produce a &lt;run_name&gt;_summary.txt file which looks like: . HG00436 *71/*2x2 HG01086 [*1/*31] Possible novel allele or suballele present: interpret with caution; experimental validation and expert review through PharmVar is recommended HG01190 *5/*68+*4 NA07048 *139/*4 NA18545 *36+*10/*36+*10 NA21105 *111/*3 . Column 1 is the sample name and column 2 is the CYP2D6 call. In order to convert this into a PharmCAT-readable format you must split this into a separate file for each sample. The following is a simple python script that parses StellarPGx's summary.txt file and outputs PharmCAT-ready external calls files for use with the -a flag. import sys import os input_path = sys.argv[1] # summary.txt file from StellarPGx output_dir = sys.argv[2] # output directory with open(input_path, \"r\") as infile: entries = infile.readlines() # read all the StellarPGx file lines into a list for entry in entries: # for each sample in the StellarPGx file split = entry.split(\"\\t\") # split the lines into columns sample = split[0] # extract the sample name call = split[1].strip(\"[] \\n\") # extract the sample call and strip excess spaces and brackets if not os.path.exists(output_dir): # create the output directory if it doesn't exist yet os.makedir(output_dir) with open(\"%s/%s_cyp2d6.txt\" % (output_dir,sample), \"w\") as outfile: # write the sample to a text file in the specified output directory outfile.write(\"CYP2D6\\t%s\" % call) . Usage example: . # python3 stellarPGx_to_PharmCAT.py summary.txt pharmcat_inputs . Where summary.txt is the StellarPGx output and pharmcat_inputs is the directory where I want my call files to be placed. If I ran the script on the summary file example from above, calling ls pharmcat_inputs to list the directory contents should show: . # ls pharmcat_inputs HG00436_cyp2d6.txt HG01086_cyp2d6.txt HG01190_cyp2d6.txt NA07048_cyp2d6.txt NA18545_cyp2d6.txt NA21105_cyp2d6.txt . and HG00436_cyp2d6.txt would look like . CYP2D6 *71/*2x2 . We urge you to manually verify that the calls in the PharmCAT-ready files correspond to the StellarPGx output. Calling CYP2D6 with PharmCAT's research mode . Once again, we do NOT recommend calling CYP2D6 from VCF! . PharmCAT can, however, call CYP2D6 if you are willing to accept all the caveats. This functionality is gated behind the -research flag. To get PharmCAT to call CYP2D6, use -research cyp2d6 . # java -jar pharmcat.jar -vcf patient_001.vcf -research cyp2d6 . ", "url": "/using/Calling-CYP2D6.html#calling-cyp2d6-anyway", "relUrl": "/using/Calling-CYP2D6.html#calling-cyp2d6-anyway" },"8": { "doc": "Determining Alleles", "title": "Determining Alleles", "content": "PharmCAT has an algorithm to match allele definitions to variant call data. The module in the PharmCAT responsible for this is the Named Allele Matcher. The Named Allele Matcher was written specifically for use in PharmCAT but can be run independently. PharmCAT can also incorporate output from other diplotype calling software (e.g. Astrolabe, Stargazer, StellarPGx etc.). These tools are run separately from PharmCAT but the results can be fed into PharmCAT to add unmatched genes or supercede diplotypes matched by PharmCAT's Named Allele Matcher. See Outside Call Format for details. For details on calling CYP2D6, plesae see Calling CYP2D6. ", "url": "/methods/determining-alleles", "relUrl": "/methods/determining-alleles" },"9": { "doc": "FAQs", "title": "Frequently Asked Questions", "content": ". | Can I use my consumer genetic testing data (23andMe / Ancestry.org / etc.) with PharmCAT? | Can PharmCAT treat missing positions as wild type? | How can I get updates about PharmCAT? | When does PharmCAT release new versions? | . ", "url": "/faqs/#frequently-asked-questions", "relUrl": "/faqs/#frequently-asked-questions" },"10": { "doc": "FAQs", "title": "Can I use my consumer genetic testing data (23andMe / Ancestry.org / etc.) with PharmCAT?", "content": "PharmCAT requires input genomic data to be in VCF format. If you can transform your data into valid VCF that meets the requirements outlined in PharmCAT documentation then you can run it. However, if you're not familiar with genomic data tools then this may be an extremely difficult task. PharmCAT does not test against datasets generated by consumer testing companies so we can make no claim about how well they work. Many consumer testing datasets have limited overlap with most of the gene definitions used by PharmCAT so this could result in results with very few callable alleles and, thus, not very useful reports. PharmCAT works best with data derived from whole genome sequencing (WGS) datasets that have good coverage. Regarding 23andMe in particular, some things to consider: . | 23andMe does genotyping and not sequencing. You will not have full coverage of the positions used by PharmCAT. This means you will have to make assumptions about those missing positions. | As of May 2021, 23andMe uses the GRCh37 assembly. This means you will have to re-align your data to the GRCh38 assembly that PharmCAT uses. | . ", "url": "/faqs/#can-i-use-my-consumer-genetic-testing-data-23andme--ancestryorg--etc-with-pharmcat", "relUrl": "/faqs/#can-i-use-my-consumer-genetic-testing-data-23andme--ancestryorg--etc-with-pharmcat" },"11": { "doc": "FAQs", "title": "Can PharmCAT treat missing positions as wild type?", "content": "PharmCAT will not be supporting this. We want people to be 100% clear on how PharmCAT works and what happens with the data you provide to it. It does not accept arbitrary VCF for many reasons (see VCF Requirements for the full list of requirements), but the main one is that we will not make any assumptions on the input you provide. We have already encountered users making assumptions on how PharmCAT works or should work which has led to confusion down the line. For one thing, we do not know what \"wild type\" is because it can vary based on your reference sequence. Did you convert it from GRCh37 to GRCh38? If so, the \"wild types\" from the two could have changed and your VCF would not provide any indications that this is the case. Secondly, a missing entry can mean that the reference base was detected OR it can mean the base was not assayed or has no call. We cannot distinguish between uncalled positions and reference in a VCF file. So we ask that you declare each required position for PharmCAT to be clear about the input. You have to decide on how accurate you want the data you provide to PharmCAT should be, especially if you're making any clinical decisions based on PharmCAT's results. If you wish to make assumptions of your data, you are welcome to do so. Instructions on how to do this can be found here. ", "url": "/faqs/#can-pharmcat-treat-missing-positions-as-wild-type", "relUrl": "/faqs/#can-pharmcat-treat-missing-positions-as-wild-type" },"12": { "doc": "FAQs", "title": "How can I get updates about PharmCAT?", "content": "The PharmCAT project is managed in GitHub which has many features for people who want to stay aware of changes happening with PharmCAT. First, sign up for a free GitHub account. Second, go to the PharmCAT repository, click the watch button, and configure notifications in a way that works for you. ", "url": "/faqs/#how-can-i-get-updates-about-pharmcat", "relUrl": "/faqs/#how-can-i-get-updates-about-pharmcat" },"13": { "doc": "FAQs", "title": "When does PharmCAT release new versions?", "content": "PharmCAT releases new versions when substantial updates are ready to be released and not on a time-based schedule. For more information see the Versioning documentation. ", "url": "/faqs/#when-does-pharmcat-release-new-versions", "relUrl": "/faqs/#when-does-pharmcat-release-new-versions" },"14": { "doc": "FAQs", "title": "FAQs", "content": " ", "url": "/faqs/", "relUrl": "/faqs/" },"15": { "doc": "Genes & Drugs", "title": "PharmCAT Genes &amp; Drugs", "content": " ", "url": "/genes-drugs/#pharmcat-genes--drugs", "relUrl": "/genes-drugs/#pharmcat-genes--drugs" },"16": { "doc": "Genes & Drugs", "title": "Genes", "content": "The following genes are used by PharmCAT to find drug recommendation data. Genes PharmCAT will attempt to match . The Named Allele Matcher will search the given sample file for locations associated with these genes and attempt to match them to known allele definitions. Each of these genes will appear in the \"Genotype Summary\" section of the final output report. | ABCG2 (2 alleles) (CPIC, PharmGKB-DPWG) | CACNA1S (3 alleles) (CPIC) | CFTR (40 alleles) (CPIC) | CYP2B6 (35 alleles) (CPIC, PharmGKB-DPWG) | CYP2C19 (34 alleles) (CPIC, PharmGKB-DPWG) | CYP2C9 (85 alleles) (CPIC, PharmGKB-DPWG) | CYP3A4 (34 alleles) (PharmGKB-DPWG) | CYP3A5 (6 alleles) (CPIC, PharmGKB-DPWG) | CYP4F2 (3 alleles) (CPIC) | DPYD (83 alleles) (CPIC, PharmGKB-DPWG) | IFNL3 (2 alleles) (CPIC) | NUDT15 (20 alleles) (CPIC, PharmGKB-DPWG) | RYR1 (49 alleles) (CPIC) | SLCO1B1 (42 alleles) (CPIC, PharmGKB-DPWG) | TPMT (46 alleles) (CPIC, PharmGKB-DPWG) | UGT1A1 (9 alleles) (CPIC, PharmGKB-DPWG) | VKORC1 (2 alleles) (CPIC, PharmGKB-DPWG) | . Genes handled by outside callers . These genes will not get allele matches from PharmCAT. However, you can use an outside caller like Astrolabe or Stargazer to get diplotype calls and then supply that to PharmCAT for use in matching recommendation data. | CYP2D6 (149 alleles) (CPIC, PharmGKB-DPWG) | G6PD (187 alleles) (CPIC) | HLA-A (CPIC, PharmGKB-DPWG) | HLA-B (CPIC, PharmGKB-DPWG) | MT-RNR1 (25 alleles) (CPIC) | . ", "url": "/genes-drugs/#genes", "relUrl": "/genes-drugs/#genes" },"17": { "doc": "Genes & Drugs", "title": "Drugs", "content": "The following drugs are included in the PharmCAT report \"Prescribing Recommendations\" section. The sources for the drug prescribing information are in brackets after the drug name. | abacavir (CPIC, PharmGKB-DPWG) | acenocoumarol (PharmGKB-DPWG) | allopurinol (CPIC, PharmGKB-DPWG) | amikacin (CPIC) | amitriptyline (CPIC, PharmGKB-DPWG) | aripiprazole (PharmGKB-DPWG) | atazanavir (CPIC) | atomoxetine (CPIC, PharmGKB-DPWG) | atorvastatin (CPIC, PharmGKB-DPWG) | azathioprine (CPIC, PharmGKB-DPWG) | brexpiprazole (PharmGKB-DPWG) | capecitabine (CPIC, PharmGKB-DPWG) | carbamazepine (CPIC, PharmGKB-DPWG) | celecoxib (CPIC) | citalopram (CPIC, PharmGKB-DPWG) | clomipramine (CPIC, PharmGKB-DPWG) | clopidogrel (CPIC, PharmGKB-DPWG) | codeine (CPIC, PharmGKB-DPWG) | desflurane (CPIC) | desipramine (CPIC) | dexlansoprazole (CPIC) | doxepin (CPIC, PharmGKB-DPWG) | efavirenz (CPIC, PharmGKB-DPWG) | eliglustat (PharmGKB-DPWG) | enflurane (CPIC) | escitalopram (CPIC, PharmGKB-DPWG) | flecainide (PharmGKB-DPWG) | flucloxacillin (PharmGKB-DPWG) | flucytosine (PharmGKB-DPWG) | fluorouracil (CPIC, PharmGKB-DPWG) | flurbiprofen (CPIC) | fluvastatin (CPIC) | fluvoxamine (CPIC) | fosphenytoin (CPIC) | gentamicin (CPIC) | haloperidol (PharmGKB-DPWG) | halothane (CPIC) | hormonal contraceptives for systemic use (PharmGKB-DPWG) | hydrocodone (CPIC) | ibuprofen (CPIC) | imipramine (CPIC, PharmGKB-DPWG) | irinotecan (PharmGKB-DPWG) | isoflurane (CPIC) | ivacaftor (CPIC) | kanamycin (CPIC) | lamotrigine (PharmGKB-DPWG) | lansoprazole (CPIC, PharmGKB-DPWG) | lornoxicam (CPIC) | lovastatin (CPIC) | meloxicam (CPIC) | mercaptopurine (CPIC, PharmGKB-DPWG) | methoxyflurane (CPIC) | metoprolol (PharmGKB-DPWG) | nortriptyline (CPIC, PharmGKB-DPWG) | omeprazole (CPIC, PharmGKB-DPWG) | ondansetron (CPIC) | oxcarbazepine (CPIC, PharmGKB-DPWG) | pantoprazole (CPIC, PharmGKB-DPWG) | paromomycin (CPIC) | paroxetine (CPIC, PharmGKB-DPWG) | peginterferon alfa-2a (CPIC) | peginterferon alfa-2b (CPIC) | phenprocoumon (PharmGKB-DPWG) | phenytoin (CPIC, PharmGKB-DPWG) | pimozide (PharmGKB-DPWG) | piroxicam (CPIC) | pitavastatin (CPIC) | plazomicin (CPIC) | pravastatin (CPIC) | propafenone (PharmGKB-DPWG) | quetiapine (PharmGKB-DPWG) | rasburicase (CPIC) | risperidone (PharmGKB-DPWG) | rosuvastatin (CPIC) | sertraline (CPIC, PharmGKB-DPWG) | sevoflurane (CPIC) | simvastatin (CPIC, PharmGKB-DPWG) | siponimod (PharmGKB-DPWG) | streptomycin (CPIC) | succinylcholine (CPIC) | tacrolimus (CPIC, PharmGKB-DPWG) | tamoxifen (CPIC, PharmGKB-DPWG) | tegafur (PharmGKB-DPWG) | tenoxicam (CPIC) | thioguanine (CPIC, PharmGKB-DPWG) | tobramycin (CPIC) | tramadol (CPIC, PharmGKB-DPWG) | trimipramine (CPIC) | tropisetron (CPIC) | venlafaxine (PharmGKB-DPWG) | voriconazole (CPIC, PharmGKB-DPWG) | warfarin (CPIC, PharmGKB-DPWG) | zuclopenthixol (PharmGKB-DPWG) | . ", "url": "/genes-drugs/#drugs", "relUrl": "/genes-drugs/#drugs" },"18": { "doc": "Genes & Drugs", "title": "Genes & Drugs", "content": " ", "url": "/genes-drugs/", "relUrl": "/genes-drugs/" },"19": { "doc": "PharmCAT Modules", "title": "PharmCAT Modules", "content": "The PharmCAT tool is really a pipeline comprised of multiple modules: . The Named AlleleMatcher module is responsible for calling diplotypes for a sample based on a VCF file. For an overview on how this works, see Named Allele Matcher 101 . The Phenotyper module is reponsible for translating diplotypes and other genotype information into gene-specific phenotypes. For example, CYP2C19 *2/*4 is a poor metabolizer. The Reporter module is responsible for generating a report with genotype-specific expert-reviewed drug prescribing recommendations for clinical decision support. ", "url": "/methods/Modules.html", "relUrl": "/methods/Modules.html" },"20": { "doc": "Multi-Sample Analysis", "title": "Multi-Sample Analysis", "content": "As of March 2022, PharmCAT only takes a single-sample VCF. If a multi-sample VCF is provided, only the first sample will be annotated. However, PharmCAT can generate a PGx report in a matter of seconds for a preprocessed VCF. The fast runtime of PharmCAT allows you to batch-annotate VCFs, with a little help from a bit of scripting, to scale from a few dozen samples to a biobank-scale cohorts in an efficient manner. This documentation shares concrete examples of how to use PharmCAT to batch process multiple samples in a High-Performance Computing (HPC) environment. We expect readers to be familiar with using both PharmCAT's VCF preprocessor and the core PharmCAT tool. In addition to the documentation, we also have a tutorial available that walks you through working with real genetic data sets. ", "url": "/using/Multi-Sample-Analysis.html", "relUrl": "/using/Multi-Sample-Analysis.html" },"21": { "doc": "Multi-Sample Analysis", "title": "Table of contents", "content": ". | Example using the Stanford Sherlock HPC . | Preprocessing the data . | Case 1 - single-sample VCFs | Case 2 - multi-sample VCF | Case 3 - multi-sample VCF divided by chromosome or into consecutive genetic blocks | . | Running PharmCAT . | Batch outside calls | . | Running individual components . | Named Allele Matcher | Phenotyper - use the Named Allele Matcher JSON data | Reporter | . | Extracting PharmCAT JSON content into TSV . | Extracting the PharmCAT Named Allele Matcher JSON data into a TSV file | Extracting the PharmCAT Phenotyper JSON data into a TSV file | . | . | Example with the Penn Medicine Biobank . | Preprocessing the data | Running PharmCAT | Reading the PharmCAT calls into Python | . | Reference | . ", "url": "/using/Multi-Sample-Analysis.html#table-of-contents", "relUrl": "/using/Multi-Sample-Analysis.html#table-of-contents" },"22": { "doc": "Multi-Sample Analysis", "title": "Example using the Stanford Sherlock HPC", "content": "This part uses the VCFs on multiple GeT-RM samples1 generated from the 30x high-coverage WGS sequencing performed by the New York Genome Center (NYGC)2. The job was run on the Stanford Sherlock cluster, a High-Performance Computing (HPC) cluster which uses Slurm as an open-source resource manager and job scheduler. The scripts to run PharmCAT on the Stanford Sherlock cluster is written in shell programming language and can be easily adapted to another HPC environment supported by a different job scheduler. Preprocessing the data . This section provides examples for working with different types of input VCFs. For the full script, see PharmCAT-tutorial/src/02_VCF_preprocessing.sh. Case 1 - single-sample VCFs . If your genetic data is already stored in single-sample VCFs, you are one step closer to running the PharmCAT. We recommend the users to still run the PharmCAT VCF preprocessor to ensure the appropriate variant representation format, which can be achieved by the following command. On the command line: . $ python3 PharmCAT_VCF_Preprocess.py --input_vcf &lt;single_sample_vcf&gt; . For example: . $ cd PharmCAT-tutorial/ $ cat data/single_sample_vcf_list.txt data/PharmCAT_tutorial_get-rm_wgs_30x_grch38.NA18526.vcf.gz data/PharmCAT_tutorial_get-rm_wgs_30x_grch38.NA18565.vcf.gz data/PharmCAT_tutorial_get-rm_wgs_30x_grch38.NA18861.vcf.gz . Sample script: . # run the preprocessor iteratively across single-sample VCFs for SINGLE_VCF in $(cat data/single_sample_vcf_list.txt) do # run the PharmCAT VCF preprocessor for a single-sample VCF python3 PharmCAT_VCF_Preprocess.py --input_vcf \"$SINGLE_VCF\" done . Case 2 - multi-sample VCF . Population- or biobank-scale VCFs most likely come in multi-sample format. The PharmCAT VCF preprocessor is designed to help the users with this case and produce multiple single-sample VCFs that PharmCAT requires. The simplest command to preprocess a multi-sample VCF is as follows. On the command line: . $ python3 PharmCAT_VCF_Preprocess.py --input_vcf &lt;multi_sample_vcf&gt; . Sample script: . cd PharmCAT-tutorial/ python3 PharmCAT_VCF_Preprocess.py --input_vcf data/PharmCAT_tutorial_get-rm_wgs_30x_grch38.vcf.gz . Case 3 - multi-sample VCF divided by chromosome or into consecutive genetic blocks . As sometimes seen with large-scale genetic studies, the genetic data may be divided into multiple by-chromosome VCFs or VCFs with consecutive genetic blocks. The PharmCAT VCF preprocessor can manage this type of genetic data sets by taking a list of VCFs as the input. On the command line: . $ python3 PharmCAT_VCF_Preprocess.py --input_list &lt;list_of_input_vcf&gt; . Sample script: . cd PharmCAT-tutorial/ # run the PharmCAT VCF preprocessor for multiple VCFs with non-overlapping genetic regions of the same cohort python3 PharmCAT_VCF_Preprocess.py --input_list data/input_vcf_list.txt . Running PharmCAT . Assuming the users have run the PharmCAT VCF preprocessor to generate multiple single-sample VCFs which is named such as pharmcat_ready_vcf.&lt;sample_id&gt;.vcf. Use the following command to batch annotate multiple VCFs using PharmCAT. A full example can be found at PharmCAT-tutorial/src/03_PharmCAT.sh. On the command line: . $ java -jar &lt;path_to_the_latest_pharmcat_jar&gt; -vcf &lt;single_sample_vcf&gt; . Sample script: . cd PharmCAT-tutorial/ # running multiple samples for SINGLE_SAMPLE in $(cat data/test_get-rm_samples.txt) do # always use the latest PharmCAT java -jar pharmcat.jar -vcf results/pharmcat_ready/pharmcat_ready.\"$SINGLE_SAMPLE\".vcf done . The output is a set of PGx reports in HTML format named as pharmcat.&lt;sample_id&gt;.report.html. Batch outside calls . To incorporate outside PGx calls with PharmCAT for multiple samples, the users have to prepare the outside PGx calls of each sample in separate files and supply the individual file as outside calls to the PharmCAT. Running individual components . You can run the individual modules of PharmCAT on multiple samples in a similar manner to how you run the whole PharmCAT pipeline. This is useful if you are interested in understanding population PGx and specifically obtaining PGx frequencies (named alleles, diplotypes, or metabolizer phenotypes) in your cohort. To do so, you can run the following commands against your data. More details and a tutorial can be found at PharmCAT-tutorial/src/03_PharmCAT.sh. Named Allele Matcher . On the command line: . $ java -jar &lt;path_to_the_latest_pharmcat_jar&gt; -matcher -vcf &lt;sample.vcf&gt; . Sample script: . cd PharmCAT-tutorial/ for SINGLE_SAMPLE in \"$(cat data/test_get-rm_samples.txt)\" do java -jar pharmcat.jar -matcher -vcf results/pharmcat_ready/pharmcat_ready_vcf.\"$SINGLE_SAMPLE\".vcf done . Phenotyper - use the Named Allele Matcher JSON data . On the command line: . $ java -jar &lt;path_to_the_latest_pharmcat_jar&gt; -phenotyper -pi &lt;sample.match.json&gt; . Sample script: . cd PharmCAT-tutorial/ for SINGLE_SAMPLE in \"$(cat data/test_get-rm_samples.txt)\" do java -jar pharmcat.jar -phenotyper -pi results/pharmcat_ready/\"$SINGLE_SAMPLE\".match.json done . Reporter . On the command line: . $ java -jar &lt;path_to_the_latest_pharmcat_jar&gt; -reporter -ri &lt;sample.phenotype.json&gt; -reporterJson . Sample script: . cd PharmCAT-tutorial/ for SINGLE_SAMPLE in \"$(cat &lt;sample_list.txt&gt;)\" do java -jar pharmcat.jar -reporter -ri \"$SINGLE_SAMPLE\".phenotype.json -reporterJson \\ -t 'Report for '\"$SINGLE_SAMPLE\" done . These commands yield Named Allele Matcher, Phenotyper, and Reporter results for each individual separately in the format of JSON files. We encourage the users to explore and perform data analysis using the rich content in these JSON files, which can be easily achieved using auxiliary JSON libraries and data analysis packages in R or python. Extracting PharmCAT JSON content into TSV . We also provide accessory R scripts that organize and extract the content from the Named Allele Matcher or Phenotyper JSON outputs into tab-separated values (TSV) files. Here is an example TSV that the users will obtain from the provided R scripts. | samples | gene | diplotype | haplotype_1 | haplotype_2 | haplotype_1_variants | haplotype_2_variants | missing_positions | . | NA18526 | ABCG2 | rs2231142 reference (G)/rs2231142 reference (G) | rs2231142 reference (G) | rs2231142 reference (G) | 88131171_G | 88131171_G | NULL | . | NA18526 | CYP3A5 | *1/*1 | *1 | *1 | 99652770_T;99665212_C;99672916_T | 99652770_T;99665212_C;99672916_T | 99660516;99676198 | . | NA18526 | SLCO1B1 | *1/*15 | *1 | *15 | 21176804_A;21176868_A;21176879_C;21176898_G;&lt;…truncated for visual clarity…&gt; | 21176804_G;21176868_A;21176879_C;&lt;…truncated for visual clarity…&gt; | 21172734;&lt;…truncated for visual clarity…&gt; | . | NA18565 | ABCG2 | rs2231142 reference (G)/rs2231142 reference (G) | rs2231142 reference (G) | rs2231142 reference (G) | 88131171_G | 88131171_G | NULL | . | NA18565 | CYP3A5 | *1/*3 | *1 | *3 | 99652770_T;99665212_C;99672916_T | 99652770_T;99665212_C;99672916_C | 99660516;99676198 | . | NA18565 | SLCO1B1 | *1/*1 | *1 | *1 | 21176804_A;21176868_A;21176879_C;&lt;…truncated for visual clarity…&gt; | 21176804_A;21176868_A;21176879_C;&lt;…truncated for visual clarity…&gt; | 21172734;;&lt;…truncated for visual clarity…&gt; | . | NA18861 | CYP3A5 | *1/*1 | *1 | *1 | 99652770_T;99665212_C;99672916_T | 99652770_T;99665212_C;99672916_T | 99660516;99676198 | . | NA18861 | SLCO1B1 | *1/*43 | *1 | *43 | 21176804_A;21176868_A;21176879_C;&lt;…truncated for visual clarity…&gt; | 21176804_G;21176868_A;21176879_A;&lt;…truncated for visual clarity…&gt; | 21172734;;&lt;…truncated for visual clarity…&gt; | . Extracting the PharmCAT Named Allele Matcher JSON data into a TSV file . cd PharmCAT-tutorial/ SCRIPT_PATH=src/organize_pharmcat_named_allele_matcher_results.R MATCHER_DIR=results/pharmcat_named_allele_matcher/ MATCHER_PATTERN=pharmcat_named_allele_matcher*json PROJECT_DIR=\"$PWD\" Rscript “$SCRIPT_PATH” \\ --input-dir \"$MATCHER_DIR\" \\ --input-file-pattern \"$MATCHER_PATTERN\" \\ --output-dir \"$PROJECT_DIR\" . Extracting the PharmCAT Phenotyper JSON data into a TSV file . cd PharmCAT-tutorial/ SCRIPT_PATH=src/organize_pharmcat_phenotyper_results.R PHENOTYPER_DIR=results/pharmcat_phenotyper/ PHENOTYPER_PATTERN=pharmcat_phenotyper*json PROJECT_DIR=\"$PWD\" Rscript \"$SCRIPT_PATH\" \\ --input-dir \"$PHENOTYPER_DIR\" \\ --input-file-pattern \"$PHENOTYPER_PATTERN\" \\ --output-dir \"$PROJECT_DIR\" . ", "url": "/using/Multi-Sample-Analysis.html#example-using-the-stanford-sherlock-hpc", "relUrl": "/using/Multi-Sample-Analysis.html#example-using-the-stanford-sherlock-hpc" },"23": { "doc": "Multi-Sample Analysis", "title": "Example with the Penn Medicine Biobank", "content": "This section provides an alternative example which is carried out on the Penn Medicine Biobank data. This example provides scripts that convert PharmCAT JSON files into a Python DataFrame and CSV/TSV . The Stanford and UPenn PharmCAT teams independently developed methods for post-processing multiple samples from PharmCAT. This method, developed by UPenn, takes the output JSON files from multiple PharmCAT runs and converts them to a DataFrame object for use in Python or export to CSV/TSV. Preprocessing the data . Before proceeding, you should preprocess your multi-sample VCF or single sample VCFs using PharmCAT's VCF preprocessor. Running PharmCAT . Running PharmCAT on the single-sample VCFs is pretty straightforward. First you need to create a text file with all of all the output file names from the preprocessor. This can easily be generated with the command: . $ ls &lt;preprocess_out_dir&gt; | grep \".vcf$\" &gt; pharmcat_inputs.txt` . Verify that this contains all the samples by taking the line count (wc -l pharmcat_inputs.txt) and ensuring it equals the number of samples. Then you need to use a for-loop to run PharmCAT repeatedly on each input file. The -reporterJson flag ensures that PharmCAT outputs JSON files for each sample containing the calls. BASE_DIR=\"~/project/preprocess_out\" # the output directory from the preprocessor OUT_DIR=\"pharmcat_out/\" # where to put the PharmCAT output for i in $(cat pharmcat_inputs.txt) # a file with the filenames of your preprocessed VCFs do SAMPLE=`echo $i | cut -d \".\" -f 2` # the sample name is in the preprocessor output filename # always use the latest version of PharmCAT java -jar pharmcat.jar -vcf ${BASE_DIR}/${i} -bf ${SAMPLE} -reporterJson -o ${OUT_DIR} done . Reading the PharmCAT calls into Python . Here is a exemplary python output for the PharmCAT Named Allele Matcher: . | SAMPLE_ID | CACNA1S | CFTR | CYP2B6 | CYP2C19 | rs12777823 | CYP2C9 | &lt;…truncated for visual clarity…&gt; | . | SAMPLE_1 | Reference/Reference | No CPIC variants found | *1/*1 | *1/*1 | G/G | *1/*1 | &lt;…truncated for visual clarity…&gt; | . | SAMPLE_2 | Reference/Reference | No CPIC variants found | *1/*1 | *1/*1 | G/G | *1/*1 | &lt;…truncated for visual clarity…&gt; | . | SAMPLE_3 | Reference/Reference | No CPIC variants found | *1/*1 | *1/*1 | G/G | *1/*1 | &lt;…truncated for visual clarity…&gt; | . Below is Python3 code for converting the JSON files from PharmCAT Named Allele Matcher and Phenotyper into Pandas DataFrames, which can be exported to CSV or processed further in python. Because of the long runtime of this process, we recommend saving the calls to CSV and loading the data from CSV when needed, instead of regenerating the DataFrames many times. # Need to give a list of sample IDs sample_list = [x.strip() for x in open(\"sample_ids.txt\", \"r\").readlines()] # PharmCAT output directory base_dir = \"~/project/pharmcat_out/\" # The following list specifies which genes should be pulled from the PharmCAT output. Be sure to include any new genes that get added to PharmCAT if they are relevant to you. genelist = [\"CACNA1S\",\"CFTR\",\"CYP2B6\",\"CYP2C19\",\"rs12777823\",\"CYP2C9\",\"CYP3A5\",\"CYP4F2\",\"DPYD\",\"IFNL3/4\",\"NUDT15\",\"RYR1\",\"TPMT\",\"UGT1A1\",\"VKORC1\",\"SLCO1B1\"] columns = [\"PID\"] + genelist for pid in sample_list: pid = str(pid) # Load in the JSON sample_file = \"{0}/{1}.report.json\".format(base_dir, pid.strip()) sample_json = json.load(open(sample_file, \"r\")) # Build a dictionary that stores the genotype and phenotype for each gene from the JSON gene2genotype = dict([(key, \"NA\") for key in genelist]) gene2phenotype = dict([(key, \"NA\") for key in genelist]) for genotype in sample_json[\"genotypes\"]: gene = genotype[\"gene\"] # since there can be multiple genotypes called due to ambiguity, join them with ';' gene2genotype[gene] = \";\".join(set(genotype[\"calls\"])) gene2phenotype[gene] = \";\".join(set(genotype[\"phenotype\"])) # Optional section: code to extract rs12777823 for Warfarin (remove rs12777823 from genelist if deleting this section) for call in sample_json[\"geneCalls\"]: if call[\"gene\"] == \"CYP2C9\": for variant in call[\"variantsOfInterest\"]: if variant[\"dbSnpId\"] == \"rs12777823\": gene2genotype[\"rs12777823\"] = variant['call'] if gene2genotype[\"rs12777823\"] is None: gene2genotype[\"rs12777823\"] = \"NA\" gene2genotype[\"rs12777823\"] = gene2genotype[\"rs12777823\"].replace(\"|\", \"/\") # Convert the dictionaries into DataFrames genotypes = pd.DataFrame(columns=columns) phenotypes = pd.DataFrame(columns=columns) ## Convert the dictionary into lists corresponding to DataFrame rows (one per sample) geno_row = [pid.strip()] + [gene2genotype[gene] for gene in gene2genotype] pheno_row = [pid.strip()] + [gene2phenotype[gene] for gene in gene2phenotype] ## Add each row to the DataFrames genotypes = genotypes.append(pd.Series(geno_row, index=genotypes.columns), ignore_index=True) phenotypes = phenotypes.append(pd.Series(pheno_row, index=phenotypes.columns), ignore_index=True) # Optional section: re-encode phenotypes from Warfarin-related genes phenotypes[\"CYP4F2\"] = genotypes[\"CYP4F2\"].apply(lambda x: \"*3\" in x).replace({False:\"not actionable\", True:\"actionable\"}) phenotypes[\"VKORC1\"] = genotypes[\"VKORC1\"].apply(lambda x: \"variant\" in x).replace({False:\"not actionable\", True:\"actionable\"}) phenotypes[\"IFNL3/4\"] = genotypes[\"IFNL3/4\"].apply(lambda x: \"variant\" in x).replace({False:\"not actionable\", True:\"actionable\"}) phenotypes[\"rs12777823\"] = genotypes[\"rs12777823\"].apply(lambda x: \"A\" in x).replace({False:\"not actionable\", True:\"actionable\"}) genotypes = genotypes.set_index(\"PID\") phenotypes = phenotypes.set_index(\"PID\") # Output the DataFrames as CSV genotypes.to_csv(\"genotypes.csv\") phenotypes.to_csv(\"phenotypes.csv\") . The genotypes and phenotypes DataFrames should have the sample ID as the index, with one sample per row and one gene per column. ", "url": "/using/Multi-Sample-Analysis.html#example-with-the-penn-medicine-biobank", "relUrl": "/using/Multi-Sample-Analysis.html#example-with-the-penn-medicine-biobank" },"24": { "doc": "Multi-Sample Analysis", "title": "Reference", "content": ". | Pratt, V. M. et al. Characterization of 137 Genomic DNA Reference Materials for 28 Pharmacogenetic Genes: A GeT-RM Collaborative Project. J Mol Diagn 18, 109–123 (2016). | Byrska-Bishop, M. et al. High coverage whole genome sequencing of the expanded 1000 Genomes Project cohort including 602 trios. 2021.02.06.430068 (2021) doi:10.1101/2021.02.06.430068. | . ", "url": "/using/Multi-Sample-Analysis.html#reference", "relUrl": "/using/Multi-Sample-Analysis.html#reference" },"25": { "doc": "Named Allele Matcher 101", "title": "Named Allele Matcher 101", "content": "The basic process: . | Read in all named allele definitions from the gene definition table. Each gene has a reference allele defined by the first definition row in the table (eg. *1). By default, any non-reference named allele that does not contain a base call for a given position (eg. blank spots in the definition table) will default to the reference row's base call. | Read in sample data (VCF file), ignoring positions that are not used in the gene definition tables. | For each gene: . | If data is unphased, generate all possible combinations of genotypes for the positions of interest. | Attempt to match each combination to a named allele.1 | If there are matches, and data is unphased, try to build diplotypes by making sure that the genotype combinations are possible. | If diplotypes can be found, they are scored and only the top-scoring diplotype(s) is returned.2 | . | . Scoring . Each named allele is given a score based on the number of variant positions used to define the allele (non-blank cells in that row). This means that the reference allele will always have the maximum score because all positions are defined for that allele. Take a look at this sample gene definition table: . |   | rs1 | rs2 | rs3 | rs4 | rs5 | score | . | *1 | C | C | T | G | A | 5 | . | *2 | T | T |   | A |   | 3 | . Since the gene definition table contains 5 positions, the reference allele, *1, gets a score of 5 while *2 only has 3 positions defined and gets a score of 3. 3 . A diplotype's score is the combined score of its component named alleles. A *1/*2 from the example above would have a score of 8. Missing Positions . If the sample data has missing positions that are required by a named allele definition, the position will be dropped from consideration. This is the only reason the score for a diplotype might be different between two samples. Examples . Using the following gene definition table: . |   | rs1 | rs2 | rs3 | rs4 | rs5 | score | . | *1 | C | C | T | G | A | 5 | . | *2 | T |   |   | A |   | 2 | . | *3 |   |   |   | A |   | 1 | . | *4 |   | T |   |   |   | 1 | . | *5 | T |   |   |   |   | 1 | . And the following (unphased) sample data: . | rs1 | rs2 | rs3 | rs4 | rs5 | . | C/T | C/C | T/T | A/G | A/A | . The potential permutations of those genotypes will match *1, *2, *3 and *5. From that, plausible diplotypes are: . | Diplotype | Score | . | 1/2 | 5 + 2 = 7 | . | 3/5 | 1 + 1 = 2 | . Which results in *1/*2 being returned. Note that *1/*3 is not a plausible diplotype because one chromosome must have a C and the other must have a T at position rs1. They can't both be C. Similarly, *2/*3 is not a plausible diplotype either because it cannot be homozygous at rs4. Missing rs5 . If we use the same gene definition table as the example above and the following (unphased) sample data, with no data available for rs5: . | rs1 | rs2 | rs3 | rs4 | rs5 | . | C/T | C/C | T/T | A/G |   | . The results would be the same, except the scores would be different: . | Diplotype | Score | . | 1/2 | 4 + 2 = 6 | . | 3/5 | 1 + 1 = 2 | . Missing rs1 . If we use the same gene definition table as the example above and the following (unphased) sample data, with no data available for rs1: . | rs1 | rs2 | rs3 | rs4 | rs5 | . |   | C/C | T/T | A/G | A/A | . Then the results would be different: . | Diplotype | Score | . | 1/2 | 4 + 1 = 5 | . | 1/3 | 4 + 1 = 5 | . As such, *1/*2 and *1/*3 would be returned. Note that *5 could never be matched in this scenario because it's definining allele is missing. Notes . 1: If sample data is not phased and we do not assume the reference for missing positions in the definition, it is possible to have multiple matches for a single named allele. 2: This behavior can be modified to return all potential diplotype matches. 3: This score is the same irregardless of whether we assume the reference for missing positions. ", "url": "/methods/NamedAlleleMatcher-101.html", "relUrl": "/methods/NamedAlleleMatcher-101.html" },"26": { "doc": "Named Allele Matcher 201", "title": "Named Allele Matcher 201", "content": "This document attempts to cover more advanced details of the Named Allele Matcher. This is really only applicable if you are defining your own named allele definitions. Scoring . The score for a given named allele is determined by the number of positions at which alleles have been provided. Example: . |   | rs1 | rs2 | rs3 | rs4 | rs5 | score | . | *1 | C | C | T | G | A | 5 | . | *2 | T | T |   | A |   | 3 | . The default named allele definitions are designed to assume that missing alleles are the same as the reference named allele, which is defined as the first named allele in the definition file. It is, however, possible to increse the score of a named allele by specifying the reference allele. For example, this gene definition table is effectively identical to the one above, but *2 has a different score. |   | rs1 | rs2 | rs3 | rs4 | rs5 | score | . | *1 | C | C | T | G | A | 5 | . | *2 | T | T | T | A | A | 5 | . Exemptions . src/main/resources/org/pharmgkb/pharmcat/definition/alleles/exemptions.json gives you a way to modify the behavior of the NamedAlleleMatcer. Ignoring Named Alleles . If you are designing your own named allele definitions, you might need to define a named allele but not want it to be considered by the Named Allele Matcher. You would need to add something like this: . { \"gene\": \"XXX\", \"ignoredAlleles\": [ \"*1S\" ], \"ignoredAllelesLc\": [ \"*1s\" ] } . Return All Diplotypes . The Named Allele Matcher can return all matching diplotypes instead of just the top scoring one(s). You would need to add something like this: . { \"gene\": \"XXX\", \"allHits\": true } . ", "url": "/methods/NamedAlleleMatcher-201.html", "relUrl": "/methods/NamedAlleleMatcher-201.html" },"27": { "doc": "Outside Call Format", "title": "Outside Call Format", "content": "Typically, PharmCAT uses variant call data to match diplotypes used to find annotations. However, you can also give diplotypes, phenotypes, or other allele calls to PharmCAT that were called by other tools. These outside call files can be supplied to the PharmCAT tool using the -po flag. ", "url": "/specifications/Outside-Call-Format.html", "relUrl": "/specifications/Outside-Call-Format.html" },"28": { "doc": "Outside Call Format", "title": "File format", "content": "The outside call file format is a tab-separated file. Lines starting with # will be ignored. Each line has up to 3 fields, separated by tabs: . | HGNC gene symbol (required) | Diplotype or single allele call (required if third column not specified) | Phenotype or other gene result (required if second column not specified) | . The second and third column should not both be specified on the same line. Different genes on different lines can mix whether they give the diplotype and phenotype values. Here's an example of an outside call file: . CYP2D6 *1/*3 G6PD B (wildtype)/B (wildtype) HLA-B *57:01 positive MT-RNR1 1555A&gt;G . Note that the HLA-B line has two tabs between the gene name and the allele presence. Also, the MT-RNR1 line specifies a since that gene is monoploid. ", "url": "/specifications/Outside-Call-Format.html#file-format", "relUrl": "/specifications/Outside-Call-Format.html#file-format" },"29": { "doc": "PharmCAT in Docker", "title": "PharmCAT in Docker", "content": "PharmCAT is available in a Docker container. ", "url": "/using/PharmCAT-in-Docker.html", "relUrl": "/using/PharmCAT-in-Docker.html" },"30": { "doc": "PharmCAT in Docker", "title": "Setup", "content": "If you are not familiar with Docker, this overview is a good starting point. You must have Docker installed to use PharmCAT via Docker. Then you can get PharmCAT from Docker Hub: . # docker pull pgkb/pharmcat . ", "url": "/using/PharmCAT-in-Docker.html#setup", "relUrl": "/using/PharmCAT-in-Docker.html#setup" },"31": { "doc": "PharmCAT in Docker", "title": "Usage", "content": "You will need to make your data accessible to the Docker container. There are many options, of which a volume mount is probably the best. However, this tutorial will use bind mounts. General usage: . # docker run --rm -v /path/to/data:/pharmcat/data pgkb/pharmcat &lt;xxx&gt; . --rm Cleans up the container automatically when you're done with it -v Bind mounts /path/to/data on your machine to /pharmcat/data in the Docker image. This will make the data available under the data subdirectory. &lt;xxx&gt; Command to run If you run ls, it will list the contents of the /pharmcat directory: . # docker run --rm -v /path/to/data:/pharmcat/data pgkb/pharmcat ls GRCh38_reference_fasta.tar PharmCAT_VCF_Preprocess.py PharmCAT_VCF_Preprocess_py3_requirements.txt data pharmcat pharmcat.jar pharmcat_positions.vcf pharmcat_positions.vcf.bgz pharmcat_positions.vcf.bgz.tbi reference.fasta.bgz reference.fasta.bgz.fai reference.fasta.bgz.gzi vcf_preprocess_exceptions.py vcf_preprocess_utilities.py . Running the VCF preprocessor . Your VCF files needs to comply with PharmCAT's requirements. PharmCAT's VCF preprocessor will handle much of this for you. # docker run --rm -v /path/to/data:/pharmcat/data pgkb/pharmcat ./PharmCAT_VCF_Preprocess.py . If you have a file /path/to/data/sample.vcf, you would use: . # docker run --rm -v /path/to/data:/pharmcat/data pgkb/pharmcat ./PharmCAT_VCF_Preprocess.py --input_vcf data/sample.vcf . Note: the GRCh38 reference is included in the Docker image, so you do not need to provide it unless you have special reference requirements. Running PharmCAT . # docker run --rm -v /path/to/data:/pharmcat/data pgkb/pharmcat ./pharmcat . After running the file /path/to/data/sample.vcf through the preprocessor, assuming the sample ID was \"SAMPLE1\", you would have gotten a file called pharmcat_ready_vcf.SAMPLE1.vcf. You can then run this through PharmCAT with: . # docker run --rm -v /path/to/data:/pharmcat/data pgkb/pharmcat ./pharmcat -vcf data/pharmcat_ready_vcf.SAMPLE1.vcf . The Docker image includes the pharmcat script, which is just a wrapper around the call to Java. For details on using PharmCAT, please see the Running PharmCAT. ", "url": "/using/PharmCAT-in-Docker.html#usage", "relUrl": "/using/PharmCAT-in-Docker.html#usage" },"32": { "doc": "Preparing VCF", "title": "Preparing VCF", "content": "This document explores the reasoning behind PharmCAT's VCF requirements and some specific examples of ways to fulfill them if you plan on preparing your VCF files yourself. If you do not intend to prepare your VCF files yourself, we highly recommend you use PharmCAT's VCF preprocessor. ", "url": "/specifications/preparing-vcf", "relUrl": "/specifications/preparing-vcf" },"33": { "doc": "Preparing VCF", "title": "Table of contents", "content": ". | Must be aligned to GRCh38 Assembly | Must have all allele-defining positions | Must normalize variant representation | The CHROM field must be in the format chr## | The QUAL and FILTER columns are not interpreted | . ", "url": "/specifications/preparing-vcf#table-of-contents", "relUrl": "/specifications/preparing-vcf#table-of-contents" },"34": { "doc": "Preparing VCF", "title": "Must be aligned to GRCh38 Assembly", "content": "PharmCAT requires VCF files aligned to GRCh38. We recommend aligning to GRCh38 from the very beginning - for example, see our pharmacogenomics NGS pipeline. While you can translate positions between assemblies, this can easily introduce errors into your data. For example, LiftOver can be problematic due to ambiguity in positions. In addition, many tools won't update the genotype. Known issue with remapping . If you use CrossMap it will update the position and reference nucleotides. However, if the reference is now the same as the alternate, it will remove the variant from the file. Likewise, NCBI Remap will not update genotypes, so even if the updated position means the variant should now be called as 0/0 it will not be updated from 1/1. Presently there are only a few positions where this matters, but this will need to be very carefully checked. Another issue with NCBI remap is that some alternates can be lost following remap. For instance: . Pre LiftOver: 2 234668879 rs57191451 CAT C,CATAT,CATATAT 0/3 Post LiftOver: 2 233760233 rs57191451 CAT CATAT,CATATAT 0/3 . We currently do not have a fix for this (NCBI has been contacted), so again you will have to check these sites carefully by hand. Example: LiftOver using the GATK . This is a GRCh37-toGRCh38 LiftOver example which uses the GATK LiftoverVcf tool on the UK Biobank genotype data in the GRCh37 coordinates. The GATK LiftoverVcf tool can update genomic coordinates. If the reference allele and alternate allele are swapped in the new genome build for a single nucleotide polymorphism (SNP) locus, the GATK LiftoverVcf can reverse-complement the SNP, update the relevant genotypes (GT), and correct AF-like INFO fields. Due to the length of the example, we host the example with detailed explanations on Google Drive. Note: this example is not meant to be a comprehensive documentation of solutions to all LiftOver issues. LiftOver may require additional data cleaning or preparation steps that are specific to your genomic data. ", "url": "/specifications/preparing-vcf#must-be-aligned-to-grch38-assembly", "relUrl": "/specifications/preparing-vcf#must-be-aligned-to-grch38-assembly" },"35": { "doc": "Preparing VCF", "title": "Must have all allele-defining positions", "content": "All positions that are used to define alleles in PharmCAT must be present in the VCF file you want to run through PharmCAT, even if they are 0/0 (reference) or ./. (missing). This is different from a typical VCF file which usually only contains variant sites. PharmCAT needs this level specificity because reference and missing alleles are interpreted differently by the allele matcher. When positions are missing from the input PharmCAT does make assumptions about whether this is because they are reference or missing. Missing positions can be added in the following way using GATK to 'EMIT_ALL_ACTIVE_SITES': . # gatk --java-options \"-Xmx4g\" HaplotypeCaller \\ -R grc38.reference.fasta -I input.bam -O output.vcf \\ -L pharmcat_positions.vcf -ip 20 --output-mode EMIT_ALL_ACTIVE_SITES . The pharmcat_positions.vcf file is available on the PharmCAT release page on GitHub. Please refer to the HaplotypeCaller documentation for details and tuning options. ", "url": "/specifications/preparing-vcf#must-have-all-allele-defining-positions", "relUrl": "/specifications/preparing-vcf#must-have-all-allele-defining-positions" },"36": { "doc": "Preparing VCF", "title": "Must normalize variant representation", "content": "Variant representation is an on-going problem in NGS (related article). For example, the following vcf lines all specify the same variant with different formats: . chr7 117548628 . GTTTTTTTA GTTTTTA . PASS CFTR:5T GT 0/1 chr7 117548628 . GTT G . PASS CFTR:5T GT 0/1 chr7 117548628 . G . PASS CFTR:5T GT 0/1 chr7 117548628 . G(T)7A G(T)5A . PASS CFTR:5T GT 0/1 . Different NGS pipelines, the way files are created (for instance if a multisample file is split), and post-processing software tools all lead to these differences. As PharmCAT is directly matching these strings to what is in the definition files this can cause problems. For example, PharmCAT expects to find deletions as the ref=\"ATCT\" alt=\"A\", rather than ref=\"TCT\" alt=\".\". Therefore you will need to replace all the deletions within in the file. If the ref is a single letter it means no variant was found, so it's safe to replace it with the appropriate nucleotide string. To avoid ambiguity in variant representation, PharmCAT is using a parsimonious, left-aligned variant representation format (as discussed in Unified Representation of Genetic Variants by Tan, Abecasis, and Kang). We recommend performing this normalization with bcftools: . # bcftools norm -m+ -c ws -Oz -o output.vcf -f grc38.reference.fasta input.vcf . | -m+ joins biallelic sites into multiallelic records (+) | -f &lt;ref_seq_fasta&gt; is the reference sequence. This flag is required for normalization | -c ws when incorrect or missing REF allele is encountered, warn (w) and set/fix(s) bad sites | . Please consult the bcftools documentation for details. Alternatively, you can use PharmCAT's VCF preprocessor, which also relies on bcftools for this. It is highly recommended that you always check the output files from these tools manually to make sure the correct format normalizations have been made. ", "url": "/specifications/preparing-vcf#must-normalize-variant-representation", "relUrl": "/specifications/preparing-vcf#must-normalize-variant-representation" },"37": { "doc": "Preparing VCF", "title": "The CHROM field must be in the format chr##", "content": "PharmCAT expects the CHROM field to have entries that begin with \"chr\" (e.g. chr1 instead of just 1). PharmCAT's VCF preprocessor takes care of this issue by automatically detecting and updating the CHROM field format. Alternatively,CHROM field format can be updated using the following command: . # perl -pe '/^((?!^chr).)*$/ &amp;&amp; s/^([^#])/chr$1/gsi' merged_output.vcf &gt; merged_output.chrfixed.vcf . ", "url": "/specifications/preparing-vcf#the-chrom-field-must-be-in-the-format-chr", "relUrl": "/specifications/preparing-vcf#the-chrom-field-must-be-in-the-format-chr" },"38": { "doc": "Preparing VCF", "title": "The QUAL and FILTER columns are not interpreted", "content": "PharmCAT considers all variants in your file, even if they fail filters. If you use a tool like VSQR you can use the following Perl one-liner to change the genotype to 0/0 if necessary: . # perl -pe '/^((?!PASS).)*$/ &amp;&amp; /^((?!0\\/0).)*$/ &amp;&amp; /^((?!0\\|0).)*$/ &amp;&amp; s/[0-9][\\/|][0-9]/0|0/' merged_output.vcf &gt; merged_output_pass.vcf . ", "url": "/specifications/preparing-vcf#the-qual-and-filter-columns-are-not-interpreted", "relUrl": "/specifications/preparing-vcf#the-qual-and-filter-columns-are-not-interpreted" },"39": { "doc": "Running PharmCAT", "title": "Running PharmCAT", "content": "This document teaches you how to use the core PharmCAT tool. ", "url": "/using/Running-PharmCAT.html", "relUrl": "/using/Running-PharmCAT.html" },"40": { "doc": "Running PharmCAT", "title": "Requirements", "content": "Install the Software . You can skip this if are running PharmCAT in Docker. | You will need Java 17 or newer. | Download the PharmCAT Jar file from our releases page. | . Prepare Your VCF Files . PharmCAT takes VCF files as input. Please make sure you have read and undertand PharmCAT's VCF requirements. If you are not preparing your VCF files yourself, we highly recommend you run your VCF file through PharmCAT's VCF preprocessor. ", "url": "/using/Running-PharmCAT.html#requirements", "relUrl": "/using/Running-PharmCAT.html#requirements" },"41": { "doc": "Running PharmCAT", "title": "Running PharmCAT", "content": "This is the basic command, which will take your VCF file and produce the PharmCAT report: . # java -jar &lt;path_to_pharmcat_jar_file&gt; -vcf &lt;vcf_file&gt; . Where: . -jar &lt;path_to_jar_file&gt; The compiled PharmCAT Jar file -vcf &lt;vcf_file&gt; Input VCF file (must comply with PharmCAT's VCF requirements) By default, the output will be saved to the same directory as the input VCF file and will use the same base file name. For example: . # java -jar pharmcat.jar -vcf /tmp/sample1.vcf Saving named allele matcher JSON results to /tmp/sample1.match.json Saving phenotyper JSON results to /tmp/sample1.phenotype.json Saving reporter HTML results to /tmp/sample1.report.html . Notice that all intermediary files will be kept. To control this behavior, provide: . -o &lt;dir&gt; or --output-dir &lt;dir&gt; Directory to save files to -bf &lt;name&gt; or --base-filename &lt;name&gt; The base name (without file extensions) used for output files -del or --delete-intermediary-files Delete intermediary output files Example: . # java -jar pharmcat.jar -vcf /tmp/input.vcf -o /tmp/results -bf sample Saving named allele matcher JSON results to /tmp/results/sample.match.json Saving phenotyper JSON results to /tmp/results/sample.phenotype.json Saving reporter HTML results to /tmp/results/sample.report.html # java -jar pharmcat.jar -vcf /tmp/input.vcf --output-dir /tmp/results -del Saving reporter HTML results to /tmp/results/input.report.html . Outside Calls . If you need to provide diplotypes directly to PharmCAT, you can do so using an \"outside calls\" file. You might want to do this for genes that PharmCAT does not call directly, or to override PharmCAT's call. To do so, provide: . -po &lt;tsv_file&gt; or --phenotyper-outside-call-file &lt;tsv_file&gt; Path to an outside call file (TSV) Example: . # java -jar pharmcat.jar -vcf /tmp/sample.vcf -po /tmp/outside_calls.tsv Saving named allele matcher JSON results to /tmp/results/sample.match.json Saving phenotyper JSON results to /tmp/results/sample.phenotype.json Saving reporter HTML results to /tmp/results/sample.report.html . ", "url": "/using/Running-PharmCAT.html", "relUrl": "/using/Running-PharmCAT.html" },"42": { "doc": "Running PharmCAT", "title": "Advanced Usage", "content": "Remember that the PharmCAT tool is composed of 3 modules: the Named Allele Matcher, the Phenotyper, and the Reporter. graph LR; MI{{vcf file}} --&gt; M[Named Allele Matcher]; M --&gt; P[Phenotyper]; PI{{\"outside call file\"}} -. optional .-&gt; P; P --&gt; R[Reporter]; R --&gt; RO([HTML report]); class M,P,R module; class PI optional; Each module has its own arguments to customize its behavior. Named Allele Matcher . -matcher run Named Allele Matcher -ma or --matcher-all-results return all possible diplotypes, not just top hits -md &lt;dir&gt; or --matcher-definitions-dir &lt;dir&gt; directory containing named allele definitions (JSON files) -matcherHtml or --matcher-save-html save named allele matcher results as HTML Phenotyper . -phenotyper run Phenotyper -pi &lt;json_file&gt; or --phenotyper-input &lt;json_file&gt; JSON results from named allele matcher -po &lt;tsv_file&gt; or --phenotyper-outside-call-file &lt;tsv_file&gt; path to an outside call file (TSV) Reporter . -reporter run Reporter -ri &lt;json_file&gt; or --reporter-input &lt;json_file&gt; JSON results from phenotyper -rt &lt;title&gt; or --reporter-title &lt;title&gt; text to add to the report title -reporterJson save reporter results as JSON Running Individual Modules . Just the Named Allele Matcher . This will call the diplotypes for the input VCF file. Examples: . # java -jar pharmcat.jar -matcher -vcf /tmp/sample.vcf Saving named allele matcher JSON results to /tmp/sample.match.json . Just the Phenotyper . This will take matcher and/or call data and output function and phenotype information for them. Examples: . # java -jar pharmcat.jar -phenotyper -pi /tmp/sample1.match.json Saving phenotyper JSON results to /tmp/results/sample1.phenotype.json # java -jar pharmcat.jar -phenotyper -pi /tmp/sample2.match.json -po /tmp/outside_calls.tsv Saving phenotyper JSON results to /tmp/results/sample2.phenotype.json # java -jar pharmcat.jar -phenotyper -po /tmp/outside_calls.tsv Saving phenotyper JSON results to /tmp/results/outside_calls.phenotype.json . Just the Reporter . This will take the phenotyper data and output the relevant drug annotations in a comprehensive HTML report. Examples: . # java -jar pharmcat.jar -reporter -ri /tmp/sample1.phenotype.json Saving reporter HTML results to /tmp/results/sample1.report.html # java -jar pharmcat.jar -reporter -ri /tmp/sample2.phenotype.json -rt \"Awesome Report\" -reporterJson Saving reporter JSON results to /tmp/results/sample1.report.json Saving reporter HTML results to /tmp/results/sample1.report.html . Combinations . Run Named Allele Matcher and Phenotyper: . # java -jar pharmcat.jar -matcher -vcf /tmp/sample1.vcf -phenotyper Saving named allele matcher JSON results to /tmp/sample1.match.json Saving phenotyper JSON results to /tmp/results/sample1.phenotype.json # java -jar pharmcat.jar -matcher -vcf /tmp/sample2.vcf -phenotyper -po /tmp/outside_calls.tsv Saving named allele matcher JSON results to /tmp/sample2.match.json Saving phenotyper JSON results to /tmp/results/sample2.phenotype.json . Run Phenotyper and Reporter: . # java -jar pharmcat.jar -phenotyper -pi /tmp/sample1.phenotype.json -po /tmp/outside_calls.tsv -reporter Saving phenotyper JSON results to /tmp/results/sample1.phenotype.json Saving reporter HTML results to /tmp/results/sample1.report.html # java -jar pharmcat.jar -phenotyper -po /tmp/outside_calls.tsv -reporter Saving phenotyper JSON results to /tmp/results/outside_calls.phenotype.json Saving reporter HTML results to /tmp/results/outside_calls.report.html . Research-Only Options . PharmCAT has a couple experimental options that enables non-standard functionality. These options are non-standard because they're meant for resarch use only! . Calling combinations and partials . If given the --research combinations flag, PharmCAT will try to call combinations and partials. These are only called if an exact match with a named allele cannot be found. A combination is when a sample matches a combination of 2 or more named alleles. For example, CYP2B6 *6 + *14/*13. A partial is when a sample matches all the core variants of a named allele but also has additional variants. For example, CYP2C19 \"*2/*17 + g.94781859G&gt;A\". The most extreme case of a partial is when it happens off the reference allele. A partial off the reference allele will only be called if the data is phased, or the unphased data only has 2 possible sequence combinations. Calling CYP2D6 . For details on calling CYP2D6 in PharmCAT, see Calling CYP2D6. This option is not listed here because we do NOT recommend calling CYP2D6 from VCF, and Calling CYP2D6 explains why and what your options are. ", "url": "/using/Running-PharmCAT.html#advanced-usage", "relUrl": "/using/Running-PharmCAT.html#advanced-usage" },"43": { "doc": "VCF Preprocessor", "title": "PharmCAT VCF Preprocessor", "content": "The PharmCAT VCF preprocessor is a script that can preprocess VCF files for PharmCAT. This tool will: . | Strip out PGx positions that PharmCAT does not care about. | Break down a multi-sample VCF to multiple single-sample VCF files. | Automatically download the necessary Human Reference Genome Sequence FASTA and index files from the NIH FTP site if they are not provided. | Perform VCF normalization - a standardization process that turns VCF into a parsimonious, left-aligned variant representation format (as discussed in Unified Representation of Genetic Variants by Tan, Abecasis, and Kang). | Normalize the multiallelic variant representation to PharmCAT's expectation. | Process a subset of samples if a sample file is provided. | . The PharmCAT VCF preprocessing produces two types of output: . | One or more PharmCAT-ready, single-sample VCF file(s) | A report of missing pharmacogenomics core allele defining positions in user's input | . ", "url": "/using/VCF-Preprocessor.html#pharmcat-vcf-preprocessor", "relUrl": "/using/VCF-Preprocessor.html#pharmcat-vcf-preprocessor" },"44": { "doc": "VCF Preprocessor", "title": "How to run the PharmCAT VCF preprocessing tool", "content": "Prerequisite . We assume that the input VCF files are prepared following the Variant Call Format (VCF) Version &gt;= 4.1. To run the tool, you need to download the following bioinformatic tools: . | bcftools &gt;= v1.15 | htslib &gt;= v1.15 | . We assume a working python3 installation with necessary dependencies: . | python &gt;= 3.9.4 | pandas &gt;= 1.4.2 | scikit-allel &gt;= 1.3.5 | . To install necessary python packages, run the following code . $ pip3 install -r PharmCAT_VCF_Preprocess_py3_requirements.txt . Command line . To normalize and prepare a VCF file (single or multiple samples) for PharmCAT, run the following code substituted with proper arguments/inputs: . $ python3 PharmCAT_VCF_Preprocess.py --input_vcf path/to/compressed_vcf.vcf.gz . Mandatory argument: either --input_vcf or --input_list. --input_vcf Path to a single VCF file --input_list Path to file containing list of paths to VCF files (one per line), sorted by chromosome position. All VCF files must have the same set of samples. Use this when data for a sample has been split among multiple files (e.g. VCF files from large cohorts, such as UK Biobank). Example valid input_list file: . chr1_set1.vcf chr1_set2.vcf chr2_set1.vcf chr2_set2.vcf ... Example invalid input_list file: . chr3_set2.vcf chr2_set2.vcf chr1_set1.vcf chr1_set2.vcf ... VCF files can have more than 1 sample and should be bgzip compressed. If not bgzip compressed, they will be automatically bgzipped. Optional arguments: . --ref_pgx_vcf A sorted, compressed VCF of PGx core allele defining positions used by PharmCAT, by default, pharmcat_positions.vcf.bgz under the current working directory. You can find this VCF in the pharmcat_preprocessor-&lt;release_version&gt;.tar.gz available from the PharmCAT GitHub releases page. --ref_seq The GRCh38.p13 FASTA file. The FASTA file has to be decompressed and indexed (.fai). These mandatory files will be automatically downloaded (~1GB) from the NIH FTP site to the current working directory if not provided by user (see Notes for details). --sample_file The list of samples to be processed and prepared for PharmCAT. The file should contain one sample per line. --path_to_bcftools Bcftools must be installed. This argument is optional if users can run bcftools directly using the command line bcftools &lt;commands&gt;. Alternatively, users can download and compile bcftools and provide the path to the executable bcftools program as /path/to/executable/bcftools. --path_to_tabix Similar to bcftools, tabix must be installed. Tabix is a part of the htslib. If users cannot directly run tabix using the command line tabix &lt;commands&gt;, the alternative is to download and compile htslib and provide the path to the executable tabix program as /path/to/executable/tabix which should be under the htslib program folder. --path_to_bgzip Similar to tabix, bgzip must be installed. Bgzip is a part of the htslib. If users cannot directly run bgzip using the command line bgzip &lt;commands&gt;, the alternative is to download and compile htslib and provide the path to the executable bgzip program as /path/to/executable/bgzip which should be under the htslib program folder. --output_folder Output a compressed PharmCAT VCF file to /path/to/output/pharmcat/vcf. The default is the parent directory of the input. --output_prefix Prefix of the output VCF files. Default is pharmcat_ready_vcf. --keep_intermediate_files This option will help you save useful intermediate files, for example, a normalized, multiallelic VCF named input_prefix.pgx_regions.normalized.multiallelic.vcf.gz, which will include all PGx regions from the first position to the last one in each chromosome as listed in the reference PGx VCF. -0 or --missing_to_ref This option will add missing PGx positions to the output. Missing PGx positions are those whose genotypes are all missing \"./.\" in every single sample. | This option will not convert \"./.\" to \"0/0\" if any other sample has non-missing genotype at this position as these missing calls are likely missing for good reasons. | This SHOULD ONLY BE USED if you are sure your data is reference at the missing positions instead of unreadable/uncallable at those positions. Running PharmCAT with positions as missing vs reference can lead to different results. | . Output . | 1 or more PharmCAT-ready VCF file(s), which will be named as output_prefix&gt;_&lt;sample_ID&gt;.vcf, for example, pharmcat_ready_vcf.sample_1.vcf, pharmcat_ready_vcf.sample_2.vcf, etc. | The report of missing PGx positions, which will be named as &lt;output_prefix&gt;.missing_pgx_var.vcf.gz, for example pharmcat_ready_vcf.missing_pgx_var.vcf.gz. This file only reports positions that are missing in all samples. | . If --missing_to_ref is turned on, you can use this report to trace positions whose genotypes are missing in all samples (./.) in the original input but have now been added into the output VCF(s) as reference (0/0). ", "url": "/using/VCF-Preprocessor.html#how-to-run-the-pharmcat-vcf-preprocessing-tool", "relUrl": "/using/VCF-Preprocessor.html#how-to-run-the-pharmcat-vcf-preprocessing-tool" },"45": { "doc": "VCF Preprocessor", "title": "Tutorial", "content": "Case 1 - single-sample VCF . Imagine we have a VCF named \"test_1.vcf.gz\" to be used in PharmCAT. $ gunzip -c test_1.vcf.gz $ cat test_1.vcf &lt;...header truncated...&gt; #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT Sample_1 2 233760233 rs3064744 C CAT . PASS . GT 1/0 2 233760233 rs3064744 CAT C . PASS . GT 0/0 2 233760233 rs3064744 C CATAT . PASS . GT 0/1 7 117548628 . GTTTTTTTA GTTTTTA . PASS . GT 0/1 . Command to run the PharmCAT VCF preprocessor: . $ python3 PharmCAT_VCF_Preprocess.py --input_vcf test_1.vcf.gz . VCF preprocessor will return two files in this test case. | one named \"pharmcat_ready_vcf.Sample_1.vcf\", which is a PharmCAT-ready VCF | the other named \"pharmcat_ready_vcf.missing_pgx_var.vcf.gz\" as a report of missing PGx positions. | . To be noted, the chr7 variant is not used in PharmCAT and as such, was accordingly removed by the PharmCAT VCF preprocessor. $ cat reference.Sample_1.vcf &lt;...header truncated...&gt; #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT Sample_1 chr2 233760233 rs3064744 CAT C,CATATAT,CATAT . PASS PX=UGT1A1 3/2 $ gunzip -c reference.missing_pgx_var.vcf.gz $ cat reference.missing_pgx_var.vcf &lt;...header truncated...&gt; #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT PharmCAT chr1 97078987 rs114096998 G T . PASS PX=DPYD GT 0/0 chr1 97078993 rs148799944 C G . PASS PX=DPYD GT 0/0 chr1 97079005 rs140114515 C T . PASS PX=DPYD GT 0/0 &lt;...truncated...&gt; . Case 2 - multi-sample VCF . Imagine we have a VCF named \"test_2.vcf.gz\" that has two samples with different sample names from the case 1. $ gunzip -c example.vcf.gz &lt;...header truncated...&gt; #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT Sample_1 Sample_2 1 97740414 rs72549309 AATGA A . PASS . GT 1/0 0/1 2 233760233 rs3064744 C CAT . PASS . GT 1/0 0/0 2 233760233 rs3064744 CAT C . PASS . GT 0/0 0/1 2 233760233 rs3064744 C CATAT . PASS . GT 0/1 1/0 7 117548628 . GTTTTTTTA GTTTTTA . PASS . GT 0/1 1/0 10 94942212 rs1304490498 AAGAAATGGAA A . PASS . GT 1/0 0/1 13 48037826 rs777311140 G GCGGG . PASS . GT 1/0 0/1 19 38499645 rs121918596 GGAG G . PASS . GT 1/0 0/1 22 42130727 . AG A . PASS . GT 1/0 0/1 M 1555 . G A PASS . GT 1/0 0/1 . Command to run the PharmCAT VCF preprocessor: . $ python3 PharmCAT_VCF_Preprocess.py --input_vcf test_2.vcf.gz . VCF preprocessor will return three (3) files in this test case. | one named \"pharmcat_ready_vcf.s1.vcf\". Note that the output PharmCAT-ready VCFs will use the exact sample names from the input VCF. | one named \"pharmcat_ready_vcf.s2.vcf\" | the third named \"pharmcat_ready_vcf.missing_pgx_var.vcf.gz\" as a report of missing PGx positions. | . $ cat reference.Sample_1.vcf &lt;...header truncated...&gt; #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT Sample_1 chr1 97740410 rs72549309 GATGA G . PASS PX=DPYD GT 1/0 chr2 233760233 rs3064744 CAT C,CATATAT,CATAT . PASS PX=UGT1A1 GT 3/2 chr10 94942205 rs1304490498 CAATGGAAAGA C . PASS PX=CYP2C9 GT 1/0 chr13 48037825 rs777311140 C CGCGG . PASS PX=NUDT15 GT 1/0 chr19 38499644 rs121918596 TGGA T . PASS PX=RYR1 GT 1/0 $ cat reference.Sample_2.vcf &lt;...header truncated...&gt; #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT Sample_2 chr1 97740410 rs72549309 GATGA G . PASS PX=DPYD GT 0/1 chr2 233760233 rs3064744 CAT C,CATATAT,CATAT . PASS PX=UGT1A1 GT 2/1 chr10 94942205 rs1304490498 CAATGGAAAGA C . PASS PX=CYP2C9 GT 0/1 chr13 48037825 rs777311140 C CGCGG . PASS PX=NUDT15 GT 0/1 chr19 38499644 rs121918596 TGGA T . PASS PX=RYR1 GT 0/1 $ gunzip -c reference.missing_pgx_var.vcf.gz &lt;...header truncated...&gt; #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT PharmCAT chr1 97078987 rs114096998 G T . PASS PX=DPYD GT 0/0 chr1 97078993 rs148799944 C G . PASS PX=DPYD GT 0/0 chr1 97079005 rs140114515 C T . PASS PX=DPYD GT 0/0 &lt;...truncated...&gt; . Notes . As of Jan 2022, the latest Human Reference Genome assembly is GRCh38.p13. It is available through the NCBI RefSeq FTP site. PharmCAT uses the sequence and index files: . | GCA 000001405.15 GRCh38 sequence | GCA 000001405.15 GRCh38 index | . For more information on GRCh38.p13, please refer to the pertinent NCBI Assembly Website. Download and preparation of the human reference genome followed this blog. ", "url": "/using/VCF-Preprocessor.html#tutorial", "relUrl": "/using/VCF-Preprocessor.html#tutorial" },"46": { "doc": "VCF Preprocessor", "title": "VCF Preprocessor", "content": " ", "url": "/using/VCF-Preprocessor.html", "relUrl": "/using/VCF-Preprocessor.html" },"47": { "doc": "VCF Requirements", "title": "PharmCAT VCF Requirements", "content": "PharmCAT expects the incoming VCF files to follow the official VCF spec. In addition, PharmCAT expects incoming VCF to have the following properties: . | Build version must be aligned to the GRCh38 assembly (aka b38, hg38, etc.). | Any position not in the input VCF is assumed to be a \"no call\". Missing positions will not be interpreted as reference. You must specify all positions in the input VCF that you want to be considered. | Use a parsimonious, left aligned variant representation format. | Have insertions and deletions normalized to the expected representation. | The CHROM field must be in the format chr##. | The QUAL and FILTER columns are not interpreted. It is left to the user to remove data not meeting quality criteria before passing it to PharmCAT. | Should only have data for a single sample. If it's a multi-sample VCF file, only the first sample is used. | . Variant Representation Format . To avoid ambiguity in variant representation, PharmCAT is using a parsimonious, left-aligned variant representation format (as discussed in Unified Representation of Genetic Variants by Tan, Abecasis, and Kang). Insertions &amp; Deletions . Deletions . PharmCAT expects deletions to be represented with an \"anchoring\" base at the beginning of the REF sequence and then the anchoring base to also appear in the ALT sequence. For example, the following shows a deletion of AGAAATGGAA: . #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT SAMPLE chr10 94942212 . AAGAAATGGAA A . PASS desired-deletion-format GT 0/1 . as opposed to the unwanted format: . #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT SAMPLE chr10 94942212 . AGAAATGGAA . PASS do-not-want GT 0/1 . If the REF is a single letter it means no variant was found, so it's safe to replace it with the appropriate nucleotide string. Insertions . Similarly, PharmCAT expects to find insertions with a reference base REF=\"A\" ALT=\"ATCT\". For example, here's an insertion of A: . #CHROM POS ID REF ALT QUAL FILTER INFO FORMAT SAMPLE chr7 99652770 rs41303343 T TA . PASS desired-insertion-format GT 0/1 . ", "url": "/specifications/VCF-Requirements.html#pharmcat-vcf-requirements", "relUrl": "/specifications/VCF-Requirements.html#pharmcat-vcf-requirements" },"48": { "doc": "VCF Requirements", "title": "More Information", "content": "Every PharmCAT release includes a pharmcat_positions.vcf VCF file that contains all positions of interest to PharmCAT. For more details about fulfilling these requirements for PharmCAT read the Preparing VCF Files page. See PharmCAT's VCF Preprocessor for a script to automate some of these steps. ", "url": "/specifications/VCF-Requirements.html#more-information", "relUrl": "/specifications/VCF-Requirements.html#more-information" },"49": { "doc": "VCF Requirements", "title": "VCF Requirements", "content": " ", "url": "/specifications/VCF-Requirements.html", "relUrl": "/specifications/VCF-Requirements.html" },"50": { "doc": "Versioning", "title": "Versioning &amp; Releases", "content": "As our team continues to work on the PharmCAT tool we will release new versions of the tool. These versions can be found on the GitHub releases page. Versions are identified by a version number (e.g. v1.6.0). The numbering follows the rules of Conventional Commit. Each release includes documentation describing what has changed since the previous release. PharmCAT uses git as its version control system so you can examine each individual change by looking through the git commit log. We highly recommend you use the latest available release of PharmCAT and keep an eye out for new releases. A good way to stay up-to-date is to use the GitHub notifications system. ", "url": "/methods/versioning/#versioning--releases", "relUrl": "/methods/versioning/#versioning--releases" },"51": { "doc": "Versioning", "title": "When do we release a new version?", "content": "New versions of PharmCAT are released when there is one or more substantial changes that are deemed ready by the PharmCAT team. A substantial change can be one of the following: . | a new feature | an update from a data source (e.g. PharmVar, CPIC) | a fix for a problem reported by a user | an improvement for an existing feature | . There is no time-based schedule for releasing new versions of PharmCAT. ", "url": "/methods/versioning/#when-do-we-release-a-new-version", "relUrl": "/methods/versioning/#when-do-we-release-a-new-version" },"52": { "doc": "Versioning", "title": "Versioning", "content": " ", "url": "/methods/versioning/", "relUrl": "/methods/versioning/" },"53": { "doc": "Disclaimers and Other Information", "title": "Disclaimers and Other Information", "content": "Liability: PhamCAT assumes no responsibility for any injury to person or damage to persons or property arising out of, or related to any use of PharmCAT, or for any errors or omissions. The user recognizes that PharmCAT is a research tool and that they are using PharmCAT at their own risk. ", "url": "/disclaimers/", "relUrl": "/disclaimers/" },"54": { "doc": "Disclaimers and Other Information", "title": "A. Allele and Genotype Determination", "content": ". | PharmCAT uses gene allele definitions included in the CPIC database, with exceptions as noted in Gene Definition Exceptions document. For allele definitions and the positions used in PharmCAT, see the gene definition tables. | PharmCAT results are dependent on the supplied vcf calls for the queried positions (for technical information about PharmCAT input formatting and requirements, please go to pharmcat.org). PharmCAT does not assume any reference calls for positions missing from the submitted vcf file; all missing queried positions are not considered in the allele determination process. See the gene definition tables for more information about what positions are queried in the vcf file. Missing positions might alter the assigned genotype, subsequent phenotype prediction and CPIC recommendation. If the supplied vcf file is missing positions, those positions will be noted in Section 3: Allele Calls for each gene of this report. For the most reliable allele determination, reference calls as well as variant calls in the vcf file for every queried position must be provided by the user. | For cytochrome P450 genes, TPMT, NUDT15, UGT1A1, and SLCO1B1, the *1 allele is defined by the absence of variation specified in the gene definition tables. This allele cannot be identified by variants; rather, *1 is assigned by default when no variation for the queried positions is reported in the submitted vcf file. The same is true for all other genes with multiple variant positions in the definition table (CACNA1S, CFTR, DPYD, RYR1): the reference sequence is the default result when variants are not reported in the vcf file. It is always possible un-interrogated variation can occur which could potentially affect allele function, but because it is undetected, the assignment would be defaulted to a *1 (or reference) allele and normal function. | For all genes, variation reported in the vcf file but NOT included in the gene definition table will not be considered during allele assignment. There is a possibility that any such variation results in a reduced or no activity allele which could lead to inaccurate phenotype and CPIC recommendation, similar to the situation in point 3, above. | Nucleotide base calls are displayed on the positive chromosomal strand regardless of the gene strand; further information is provided under Gene-specific warnings in Section 3: Allele Calls. | PharmCAT matches variants to genotypes assuming unphased data (unless phased data is provided in the vcf file and noted as such, see pharmcat.org for details). The assumption is that defined alleles exist in trans configuration, i.e. on opposite chromosomes, with exceptions noted in Section 3: Allele Calls under \"Gene-specific warnings.\" However, in cases where an allele is defined by a combination of two or more variants, where each variant alone also defines an allele, the match is based on the longer allele. For example, TPMT*3B is defined by one SNP, *3C is defined by another SNP, and *3A is defined by the combination of those two SNPs. In the case of unphased data that is heterozygous for both SNPs, the *1/*3A genotype is returned though the possibility of *3B/*3C cannot be ruled out. Below cases are summarized for which two calls with different scores are possible when provided unphased data and heterozygous calls for the variants that define the two alleles. The genotype with the higher score (longer allele) will be used to determine allele functionality, phenotype, and recommendation but the genotype with the lower score cannot be ruled out. | . Table 1: Cases for which there is an overlap in the allele definitions. | Gene | Genotype (Higher Score) | Metabolizer phenotype | Genotype (Lower Score) | Metabolizer phenotype | . | UGT1A1 | *1/*80+*28 | Intermediate | *28/*80 | Indeterminate | . | UGT1A1 | *1/*80+*37 | Intermediate | *37/*80 | Indeterminate | . | TPMT | *1/*3A | Intermediate | *3B/*3C | Poor | . | NUDT15 | *1/*2 | Intermediate | *3/*6 | Possible Intermediate | . | CYP2C9 | *1/*71 | N/A | *10/*22 | Indeterminate | . | CYP2B6 | *1/*36 | Intermediate | *6/*22 | Intermediate | . | CYP2B6 | *1/*34 | Intermediate | *33/*36 | Indeterminate | . | CYP2B6 | *1/*6 | Intermediate | *4/*9 | Intermediate | . | CYP2B6 | *1/*7 | Intermediate | *5/*6 | Intermediate | . | CYP2B6 | *1/*13 | Intermediate | *6/*8 | Intermediate | . | SLCO1B1 | *1/*46 | Decreased function | *15/*45 | Possible Decreased Function | . | SLCO1B1 | *1/*20 | Normal Function | *19/*37 | Indeterminate | . | SLCO1B1 | *1/*12 | Indeterminate | *2/*10 | Indeterminate | . | SLCO1B1 | *1/*13 | Indeterminate | *3/*11 | Indeterminate | . | SLCO1B1 | *1/*14 | Normal Function | *4/*37 | Indeterminate | . | SLCO1B1 | *1/*15 | Decreased function | *5/*37 | Decreased function | . | SLCO1B1 | *1/*25 | Indeterminate | *4/*28 | Indeterminate | . | SLCO1B1 | *1/*31 | Decreased function | *9/*37 | Decreased Function | . | SLCO1B1 | *1/*32 | Indeterminate | *4/*24 | Indeterminate | . | SLCO1B1 | *1/*40 | Indeterminate | *5/*19 | Possible Decreased Function | . | SLCO1B1 | *1/*43 | Indeterminate | *4/*44 | Indeterminate | . Table 2: Cases for which there is an overlap in the allele definitions because the definition of the non-*1 allele in the genotype with the higher score allows for reference or variant at the position that defines the first allele listed in the genotype with the lower score. Both genotypes cannot be ruled out with unphased data if the position that overlaps between the respectives alleles is heterozygous (0/1) in addition to heterozyous calls for the other variants that define the non-*1 allele in the genotype with the higher score. | Gene | Genotype (Higher Score) | Metabolizer phenotype | Genotype (Lower Score) | Metabolizer phenotype | . | CYP2C19 | *1/*4 | Intermediate | *17/*4 | Intermediate | . | CYP2C19 | *1/*2 | Intermediate | *11/*2 | Intermediate | . | CYP2C19 | *1/*35 | Intermediate | *15/*35 | Intermediate | . | CYP2B6 | *1/*18 | Intermediate | *4/*18 | Indeterminate | . ", "url": "/disclaimers/#a-allele-and-genotype-determination", "relUrl": "/disclaimers/#a-allele-and-genotype-determination" },"55": { "doc": "Disclaimers and Other Information", "title": "B. CPIC Allele Function, Phenotype and Recommendation", "content": ". | All content is sourced from the CPIC database. | . ", "url": "/disclaimers/#b-cpic-allele-function-phenotype-and-recommendation", "relUrl": "/disclaimers/#b-cpic-allele-function-phenotype-and-recommendation" },"56": { "doc": "Disclaimers and Other Information", "title": "C. PharmCAT Exceptions to the CPIC Guideline Gene List", "content": ". | PharmCAT does not determine CYP2D6, G6PD, MT-RNR1, or HLA genotypes from the vcf file, but genotypes for CYP2D6, G6PD, and MT-RNR1 can be provided to PharmCAT from an outside source and the corresponding phenotype and prescribing recommendations will be included in the generated report. | HLAs are currently not included in PharmCAT. | . ", "url": "/disclaimers/#c-pharmcat-exceptions-to-the-cpic-guideline-gene-list", "relUrl": "/disclaimers/#c-pharmcat-exceptions-to-the-cpic-guideline-gene-list" },"57": { "doc": "Disclaimers and Other Information", "title": "D. CPIC Guideline Disclaimers and Caveats", "content": ". | A version of the following quoted disclaimer is part of each CPIC guideline and applies to the CPIC recommendations as used in PharmCAT. For the full description of potential benefits and risks, additional considerations (general and specific to gene-drug pairs), limitations, information about respective gene nomenclature systems, potential drug-drug interactions and clinical factors to consider, please see individual CPIC guidelines (cpicpgx.org). | \"CPIC guidelines reflect expert consensus based on clinical evidence and peer-reviewed literature available at the time they are written and are intended only to assist clinicians in decision making and to identify questions for further research. New evidence may have emerged since the time a guideline was submitted for publication. Guidelines are limited in scope and are not applicable to interventions or diseases not specifically identified. Guidelines do not account for all individual variations among patients and cannot be considered inclusive of all proper methods of care or exclusive of other treatments. It remains the responsibility of the health-care provider to determine the best course of treatment for a patient. Adherence to any guidelines is voluntary, with the ultimate determination regarding its application to be made solely by the clinician and the patient. CPIC assumes no responsibility for any injury to persons or damage to persons or property arising out of or related to any use of CPIC's guidelines, or for any errors or omissions.\" (PMID: 27997040) | \"Caveats: appropriate use and/or potential misuse of genetic tests. The application of genotype-based dosing is most appropriate when initiating therapy with a tricyclic. Obtaining a pharmacogenetic test after months of drug therapy may be less helpful in some instances, as the drug dose may have already been adjusted based on plasma concentrations, response, or side effects. Similar to all diagnostic tests, genetic tests are one of several pieces of clinical information that should be considered before initiating drug therapy.\" (PMID: 27997040) | . | CPIC guidelines reflect the alleles/genotypes known and considered by the guideline authors for inclusion by the time of publication, however they may be updated online at cpicpgx.org and in the CPIC database in between publications. Additional alleles and/or more extensive allele definitions might exist by the representative gene nomenclatures for various genes. | CPIC is a registered service mark of the U.S. Department of Health &amp; Human Services (HHS). | . ", "url": "/disclaimers/#d-cpic-guideline-disclaimers-and-caveats", "relUrl": "/disclaimers/#d-cpic-guideline-disclaimers-and-caveats" },"58": { "doc": "Disclaimers and Other Information", "title": "E. PharmGKB Disclaimers and Caveats", "content": ". | PharmGKB is a registered service mark of the U.S. Department of Health &amp; Human Services (HHS). | . ", "url": "/disclaimers/#e-pharmgkb-disclaimers-and-caveats", "relUrl": "/disclaimers/#e-pharmgkb-disclaimers-and-caveats" },"59": { "doc": "Gene Definition Exceptions", "title": "Gene Definition Exceptions", "content": "The genotype determination is based on CPIC gene definition tables, with the following modifications: . ", "url": "/methods/gene-definition-exceptions", "relUrl": "/methods/gene-definition-exceptions" },"60": { "doc": "Gene Definition Exceptions", "title": "SLCO1B1", "content": "CPIC provides recommendations based on the SLCO1B1 star allele genotype. The CPIC guideline for statins and SLCO1B1, ABCG2, and CYP2C9 (PMID:35152405) includes the following excerpt: \"The most common and well-studied variant in SLCO1B1 is c.521T&gt;C (rs4149056), and can be genotyped alone (e.g., PCR-based single SNV assay) or multiplexed on a variety of array-based platforms. All SLCO1B1 genetic tests should interrogate c.521T&gt;C; however, while other less common variants in this gene may have limited evidence to guide action, they may also be important”. PharmCAT attempts to determine the star allele genotype for SLCO1B1, in case no call can be determined it provides the CPIC recommendation based on the rs4149056 variant genotype. ", "url": "/methods/gene-definition-exceptions#slco1b1", "relUrl": "/methods/gene-definition-exceptions#slco1b1" },"61": { "doc": "Examples", "title": "Examples", "content": "This is a collection of example files that demonstrate input and output files from a single run of PharmCAT. For more inforamtion about running PharmCAT, read the documentation. ", "url": "/examples/", "relUrl": "/examples/" },"62": { "doc": "Examples", "title": "Input", "content": "First, a properly formatted single-sample VCF file with all positions specified. | example input VCF | . This is an example of an optional file of outside diplotype calls. This one specifies a CYP2D6 call. | example outside calls | . ", "url": "/examples/#input", "relUrl": "/examples/#input" },"63": { "doc": "Examples", "title": "Output", "content": "Named Allele Matcher output . The Named Allele Matcher component generates both HTML and JSON files with detailed information about how data in the sample VCF matches up with haplotype definitions. | example matcher HTML | example matcher JSON | . Phenotyper output . The Phenotyper component takes data from the Named Allele Matcher and combines it with outside call data to assign function and metabolizer values. | example phenotype JSON | . Reporter output . The Reporter component takes data from the Phenotyper and matches phenotypes to information found in CPIC guideline data. This data is visible in an HTML report and also in a JSON file for machine parsing. | example report HTML | example report JSON | . ", "url": "/examples/#output", "relUrl": "/examples/#output" },"64": { "doc": "Methods", "title": "PharmCAT Methods", "content": " ", "url": "/methods/#pharmcat-methods", "relUrl": "/methods/#pharmcat-methods" },"65": { "doc": "Methods", "title": "Methods", "content": " ", "url": "/methods/", "relUrl": "/methods/" },"66": { "doc": "Specifications", "title": "PharmCAT Specifications", "content": " ", "url": "/specifications/#pharmcat-specifications", "relUrl": "/specifications/#pharmcat-specifications" },"67": { "doc": "Specifications", "title": "Specifications", "content": " ", "url": "/specifications/", "relUrl": "/specifications/" },"68": { "doc": "Using PharmCAT", "title": "Using PharmCAT", "content": ". | Running PharmCAT | Running the VCF Preprocessor | Running PharmCAT in Docker | Multi-Sample Analysis | Calling-CYP2D6 | . ", "url": "/using/", "relUrl": "/using/" },"69": { "doc": "Using PharmCAT", "title": "Contributing", "content": "We welcome contributions from anyone willing to help improve PharmCAT. If you notice a bug in PharmCAT, have an idea for a new feature, or just have a question about how PharmCAT works, please submit an issue in GitHub. If you want to make a code contribution to the project please checkout the code repo and read the developer wiki for information about our development process. ", "url": "/using/#contributing", "relUrl": "/using/#contributing" },"70": { "doc": "Using PharmCAT", "title": "Important Links &amp; Data", "content": ". | CPIC Site | CPIC Guideline Publications | PharmGKB Site | List of PharmGKB clinical guideline annotations | . ", "url": "/using/#important-links--data", "relUrl": "/using/#important-links--data" },"71": { "doc": "Using PharmCAT", "title": "Meow", "content": ". ", "url": "/using/#meow", "relUrl": "/using/#meow" },"72": { "doc": "Home", "title": "PharmCAT:Pharmacogenomics Clinical Annotation Tool", "content": ". Download View on GitHub . An active area of genomic medicine implementation at many health care organizations and academic medical centers includes development of decision support and return of results around pharmacogenomics. One of the challenges in implementing pharmacogenomics is the representation of the information in clinical dosing guidelines, including star-allele haplotypes, and extracting these variants and haplotypes from genetic datasets. In a collaboration between the Pharmacogenomics Knowledgebase (PharmGKB) and the former PGRN Statistical Analysis Resource (P-STAR), with input from other groups, we are developing a software tool to extract guideline variants from a genetic dataset (represented as a vcf), interpret the variant alleles, and generate a report with genotype-based prescribing recommendations which can be used to inform treatment decisions. The Clinical Pharmacogenetics Implementation Consortium (CPIC) has established guidelines surrounding gene-drug pairs that can and should lead to treatment modifications based on genetic variants. These guidelines are used for the initial version of PharmCAT, and other sources of PGx information and guidelines will be included in the future. References: . | Commentary: TE Klein, MD Ritchie. PharmCAT: A Pharmacogenomics Clinical Annotation Tool. Clinical Pharmacology &amp; Therapeutics (2018) 104(1):19-22. | Methods paper: K Sangkuhl &amp; M Whirl-Carrillo, et al. Pharmacogenomics Clinical Annotation Tool (PharmCAT). Clinical Pharmacology &amp; Therapeutics (2020) 107(1):203-210. | . PharmCAT is under active development. ", "url": "/#pharmcatpharmacogenomics-clinical-annotation-tool", "relUrl": "/#pharmcatpharmacogenomics-clinical-annotation-tool" },"73": { "doc": "Home", "title": "Contact", "content": "Ask a Question Submit a Bug / Feature Request . ", "url": "/#contact", "relUrl": "/#contact" },"74": { "doc": "Home", "title": "Documentation", "content": "Summary of Genes and Drugs included in PharmCAT. There are detailed documents on how particular genes are handled by PharmCAT. See the gene definition exceptions for a rundown of exceptional circumstances when analyzing particular genes. Read the Methods to learn how PharmCAT works, including how it matches genotype data to allele definitions. ", "url": "/#documentation", "relUrl": "/#documentation" },"75": { "doc": "Home", "title": "Running PharmCAT", "content": "Learn how to run PharmCAT and all the different components that make up the PharmCAT tool. Please make sure to also read and understand PharmCAT's VCF requirements. ", "url": "/#running-pharmcat", "relUrl": "/#running-pharmcat" },"76": { "doc": "Home", "title": "Examples", "content": "We have an example collection of synthetic input and output files generated by PharmCAT. View examples of input and output files. ", "url": "/#examples", "relUrl": "/#examples" },"77": { "doc": "Home", "title": "Home", "content": " ", "url": "/", "relUrl": "/" } } <hr> <footer> <div> PharmCAT is managed at Stanford University & University of Pennsylvania (NHGRI U24HG010862). </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
